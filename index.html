<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypticus - Live Blockchain Gaming Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
        }
        
        .header {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .nav-item {
            padding: 0.5rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        .nav-item.active {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }
        
        .live-badge {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .wallet-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .wallet-info {
            text-align: right;
        }
        
        .connection-status {
            font-size: 0.9rem;
            color: #ff6b6b;
        }
        
        .balance {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .connect-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }
        
        .disconnect-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }
        
        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }
        
        .sidebar {
            width: 300px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            overflow-y: auto;
        }
        
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .fee-info {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .fee-info h3 {
            color: #ffd700;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .fee-info p {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .game-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        .coming-soon {
            opacity: 0.7;
            position: relative;
        }
        
        .coming-soon::after {
            content: "COMING SOON";
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .create-game-btn {
            width: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            padding: 1rem;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            margin-top: 1rem;
        }
        
        .create-game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
        }
        
        .stake-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 0.8rem;
            color: white;
            font-size: 1rem;
            margin: 1rem 0;
        }
        
        .stake-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .news-feed {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .news-item {
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid #4ecdc4;
        }
        
        .news-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #4ecdc4;
        }
        
        .news-time {
            font-size: 0.8rem;
            color: #aaa;
        }
        
        .hidden {
            display: none;
        }

        /* Chess Game Styles */
        .chess-board {
            display: grid;
            grid-template-columns: repeat(8, 60px);
            grid-template-rows: repeat(8, 60px);
            border: 3px solid #4ecdc4;
            border-radius: 10px;
            margin: 1rem auto;
            background: #f4f4f4;
        }
        
        .chess-square {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .chess-square.white {
            background: #f0d9b5;
        }
        
        .chess-square.black {
            background: #b58863;
        }
        
        .chess-square.selected {
            background: #ff6b6b !important;
            box-shadow: inset 0 0 10px rgba(255, 107, 107, 0.5);
        }
        
        .chess-square.possible-move {
            background: rgba(78, 205, 196, 0.3) !important;
        }
        
        .chess-square.possible-move::after {
            content: '‚óè';
            color: #4ecdc4;
            position: absolute;
            font-size: 1rem;
        }

        /* Checkers Game Styles */
        .checkers-board {
            display: grid;
            grid-template-columns: repeat(8, 60px);
            grid-template-rows: repeat(8, 60px);
            border: 3px solid #4ecdc4;
            border-radius: 10px;
            margin: 1rem auto;
        }
        
        .checkers-square {
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .checkers-square.dark {
            background: #8b4513;
        }
        
        .checkers-square.light {
            background: #deb887;
        }
        
        .checker-piece {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        .red-piece {
            background: radial-gradient(circle, #ff4444, #cc0000);
        }
        
        .black-piece {
            background: radial-gradient(circle, #444444, #000000);
        }
        
        .king {
            font-size: 1.2rem;
        }

        /* Word Game Styles */
        .word-game {
            max-width: 500px;
            margin: 1rem auto;
            text-align: center;
        }
        
        .word-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 1rem;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            margin: 1rem 0;
        }
        
        .word-score {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .game-status {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .game-controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            justify-content: center;
        }
        
        .game-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }
        
        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Transaction Status */
        .transaction-status {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #4ecdc4;
            border-radius: 10px;
            padding: 1rem;
            max-width: 300px;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .transaction-status.show {
            transform: translateX(0);
        }
        
        .tx-hash {
            font-family: monospace;
            font-size: 0.8rem;
            word-break: break-all;
            color: #4ecdc4;
            margin-top: 0.5rem;
        }

        /* Game Window Styles */
        .game-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.95);
    backdrop-filter: blur(15px);
    border: 2px solid #4ecdc4;
    border-radius: 15px;
    padding: 1.5rem;
    z-index: 1000;
    max-width: 90vw;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
}

/* Different z-index for each game window */
#chessGameWindow {
¬† ¬† z-index: 1001;
}

#checkersGameWindow {
¬† ¬† z-index: 1002;
}

#wordGameWindow {
¬† ¬† z-index: 1003;
}

/* Stagger window positions to prevent exact overlap */
#chessGameWindow {
¬† ¬† top: 45%;
¬† ¬† left: 45%;
}

#checkersGameWindow {
¬† ¬† top: 50%;
¬† ¬† left: 50%;
}

#wordGameWindow {
¬† ¬† top: 55%;
¬† ¬† left: 55%;
}

.game-window.minimized {
¬† ¬† top: auto;
¬† ¬† bottom: 20px;
¬† ¬† right: 20px;
¬† ¬† left: auto;
¬† ¬† transform: none;
¬† ¬† width: 300px;
¬† ¬† height: 60px;
¬† ¬† overflow: hidden;
¬† ¬† cursor: pointer;
}

/* Stack minimized windows */
#chessGameWindow.minimized {
¬† ¬† bottom: 90px;
}

#checkersGameWindow.minimized {
¬† ¬† bottom: 160px;
}

#wordGameWindow.minimized {
¬† ¬† bottom: 230px;
}

/* Active Game Lobby Styles */
.active-games {
¬† ¬† background: rgba(255, 255, 255, 0.05);
¬† ¬† border-radius: 15px;
¬† ¬† padding: 1.5rem;
¬† ¬† margin-bottom: 2rem;
}

.game-lobby-item {
¬† ¬† display: flex;
¬† ¬† justify-content: space-between;
¬† ¬† align-items: center;
¬† ¬† padding: 1rem;
¬† ¬† margin: 0.5rem 0;
¬† ¬† background: rgba(255, 255, 255, 0.05);
¬† ¬† border-radius: 8px;
¬† ¬† border-left: 3px solid #4ecdc4;
¬† ¬† transition: all 0.3s ease;
}

.game-lobby-item:hover {
¬† ¬† background: rgba(255, 255, 255, 0.1);
¬† ¬† transform: translateX(5px);
}

.join-game-btn {
¬† ¬† background: linear-gradient(45deg, #00ff88, #00cc6a);
¬† ¬† border: none;
¬† ¬† padding: 0.5rem 1rem;
¬† ¬† border-radius: 20px;
¬† ¬† color: black;
¬† ¬† font-weight: bold;
¬† ¬† cursor: pointer;
¬† ¬† transition: all 0.3s ease;
}

.join-game-btn:hover {
¬† ¬† transform: translateY(-2px);
¬† ¬† box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
}

        
        .game-window.minimized {
            top: auto;
            bottom: 20px;
            right: 20px;
            left: auto;
            transform: none;
            width: 300px;
            height: 60px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .game-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .game-window-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .game-window-controls {
            display: flex;
            gap: 0.5rem;
        }
        
        .window-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }
        
        .window-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .minimize-btn {
            background: rgba(255, 193, 7, 0.3);
        }
        
        .close-btn {
            background: rgba(220, 53, 69, 0.3);
        }
        
        .game-window-content {
            display: block;
        }
        
        .game-window.minimized .game-window-content {
            display: none;
        }
        
        .game-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 999;
        }
        
        .game-overlay.hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
                flex-wrap: wrap;
            }
            
            .nav-menu {
                position: fixed;
                top: 80px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 80px);
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(10px);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                padding-top: 2rem;
                gap: 2rem;
                transition: left 0.3s ease;
                z-index: 1000;
            }
            
            .nav-menu.active {
                left: 0;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
                padding: 1rem;
            }
            
            .content-area {
                order: 1;
                padding: 1rem;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .chess-board, .checkers-board {
                grid-template-columns: repeat(8, 40px);
                grid-template-rows: repeat(8, 40px);
            }
            
            .chess-square, .checkers-square {
                font-size: 1.5rem;
            }
            
            .checker-piece {
                width: 35px;
                height: 35px;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="logo">CRYPTICUS</div>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
        <div class="nav-menu" id="navMenu">
            <div class="nav-item active" onclick="showSection('games')">üéÆ Games</div>
            <div class="nav-item" onclick="showSection('leaderboard')">üèÜ Leaderboard</div>
            <div class="nav-item" onclick="showSection('profile')">üë§ Profile</div>
            <div class="nav-item" onclick="showSection('chat')">üí¨ Chat</div>
            <div class="nav-item" onclick="showSection('news')">üì∞ News</div>
            <div class="nav-item" onclick="showSection('settings')">‚öôÔ∏è Settings</div>
        </div>
        <div class="live-badge">üî¥ LIVE ON CORE</div>
        <div class="wallet-section">
            <div class="wallet-info">
                <div class="connection-status" id="connectionStatus">üî¥ Not Connected</div>
                <div class="balance" id="balanceDisplay">0.00 CORE</div>
            </div>
            <button class="connect-btn" id="connectBtn">Connect Wallet</button>
            <button class="disconnect-btn hidden" id="disconnectBtn">Disconnect</button>
        </div>
    </div>
    
    <!-- Transaction Status Popup -->
    <div class="transaction-status" id="transactionStatus">
        <div id="txStatusMessage">Processing transaction...</div>
        <div class="tx-hash" id="txHash"></div>
    </div>
    
    <div class="main-container">
        <div class="sidebar">
            <div class="news-feed">
                <h3>üì∞ Live Game Feed</h3>
                <div id="gameFeed">
                    <div class="news-item">
                        <div class="news-title">üéÆ Active Games: 12</div>
                        <div class="news-time">Players online now</div>
                    </div>
                    <div class="news-item">
                        <div class="news-title">üí∞ Total Pool: 156.7 CORE</div>
                        <div class="news-time">Live betting volume</div>
                    </div>
                    <div class="news-item">
                        <div class="news-title">üèÜ Last Winner: CryptoKing</div>
                        <div class="news-time">Won 5.2 CORE in Chess</div>
                    </div>
                </div>
            </div>
        </div>
                <!-- Age Verification Modal -->
        <div id="ageVerificationModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; display: none; align-items: center; justify-content: center;">
            <div style="background: rgba(0,0,0,0.95); border: 2px solid #4ecdc4; border-radius: 15px; padding: 2rem; text-align: center; max-width: 400px;">
                <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üîû Age Verification Required</h3>
                <p style="margin-bottom: 1.5rem;">You must be 18 or older to use this platform.</p>
                <p style="margin-bottom: 1.5rem; font-size: 0.9rem; color: #aaa;">By proceeding, you confirm you meet age requirements and agree to our terms.</p>
                <button onclick="verifyAge(true)" style="background: linear-gradient(45deg, #4ecdc4, #44a08d); border: none; padding: 1rem 2rem; border-radius: 25px; color: white; font-weight: bold; margin: 0.5rem; cursor: pointer;">I am 18+</button>
                <button onclick="verifyAge(false)" style="background: linear-gradient(45deg, #ff6b6b, #ee5a52); border: none; padding: 1rem 2rem; border-radius: 25px; color: white; font-weight: bold; margin: 0.5rem; cursor: pointer;">Under 18</button>
            </div>
        </div>

        <!-- Game Windows -->
    <div class="game-overlay hidden" id="gameOverlay"></div>

    <!-- Chess Game Window -->
    <div class="game-window hidden" id="chessGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">‚ôüÔ∏è Chess Masters</div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('chess')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('chess')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-status" id="chessStatus">Waiting for opponent...</div>
            <div class="chess-board" id="chessBoard"></div>
            <div class="game-controls">
                <button class="game-btn" onclick="resignChess()">Resign</button>
                <button class="game-btn" onclick="drawChess()">Offer Draw</button>
            </div>
        </div>
    </div>

    <!-- Checkers Game Window -->
    <div class="game-window hidden" id="checkersGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">‚ö´ Checkers Pro</div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('checkers')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('checkers')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-status" id="checkersStatus">Waiting for opponent...</div>
            <div class="checkers-board" id="checkersBoard"></div>
            <div class="game-controls">
                <button class="game-btn" onclick="resignCheckers()">Resign</button>
            </div>
        </div>
    </div>

    <!-- Word Game Window -->
    <div class="game-window hidden" id="wordGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">üìù Word Battle</div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('word')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('word')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-status" id="wordStatus">Round 1 of 3</div>
            <div class="word-game">
                <h4 id="wordPrompt">Make a word with these letters:</h4>
                <div id="wordLetters" style="font-size: 2rem; color: #4ecdc4; margin: 1rem 0;">BLOCKCHAIN</div>
                <input type="text" class="word-input" id="wordInput" placeholder="Enter your word..." maxlength="20">
                <div class="word-score">
                    <div>Your Score: <span id="playerScore">0</span></div>
                    <div>Opponent: <span id="opponentScore">0</span></div>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="submitWord()">Submit Word</button>
                    <button class="game-btn" onclick="skipRound()">Skip Round</button>
                </div>
            </div>
        </div>
    </div>
        
        <div class="content-area">
            <!-- Games Section -->
            <div id="gamesSection">
                <div class="fee-info">
                    <h3>üèÜ Smart Contract Gaming</h3>
                    <p><strong>97% of every stake goes directly to the winner!</strong></p>
                    <p>Powered by Core Blockchain ‚Ä¢ Instant payouts ‚Ä¢ Provably fair</p>
                    <p>Contract Address: 0x1234...5678 (Verified ‚úÖ)</p>
                </div>

                    <div class="legal-notice">
        <h4>‚öñÔ∏è Legal Notice</h4>
        <p>‚Ä¢ Educational gaming platform for skill development</p>
        <p>‚Ä¢ Minimum age: 18+ required</p>
        <p>‚Ä¢ Tax obligations: Players responsible for local tax compliance</p>
        <p>‚Ä¢ Not available in restricted jurisdictions</p>
    </div>
                    
                <div class="active-games">
    <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üéØ Active Games - Join Now!</h3>
    <div id="activeGamesList">
        <div class="game-lobby-item">
            <div>
                <strong>‚ôüÔ∏è Chess Masters</strong>
                <div style="font-size: 0.9rem; color: #aaa;">CryptoKing ‚Ä¢ Stake: 0.5 CORE</div>
            </div>
            <button class="join-game-btn" onclick="joinGame('chess', '0x123...', 0.5)">Join Game</button>
        </div>
        
        <div class="game-lobby-item">
            <div>
                <strong>‚ö´ Checkers Pro</strong>
                <div style="font-size: 0.9rem; color: #aaa;">GameMaster ‚Ä¢ Stake: 0.3 CORE</div>
            </div>
            <button class="join-game-btn" onclick="joinGame('checkers', '0x456...', 0.3)">Join Game</button>
        </div>
        
        <div class="game-lobby-item">
            <div>
                <strong>üìù Word Battle</strong>
                <div style="font-size: 0.9rem; color: #aaa;">WordWizard ‚Ä¢ Stake: 0.8 CORE</div>
            </div>
            <button class="join-game-btn" onclick="joinGame('words', '0x789...', 0.8)">Join Game</button>
        </div>
        
        <div id="noActiveGames" class="hidden" style="text-align: center; padding: 2rem; color: #aaa;">
            No active games right now. Create one below! üéÆ
        </div>
    </div>
</div>
                
                <h2>üéÆ Blockchain Games (LIVE)</h2>
                <div class="games-grid">
                    <div class="game-card" id="chessCard">
                        <h3>‚ôüÔ∏è Chess Masters</h3>
                        <p>Play chess with real CORE stakes! Smart contract ensures fair play.</p>
                        <input type="number" class="stake-input" id="chessStake" placeholder="Enter stake (min 0.01 CORE)" min="0.01" step="0.01">
                        <button class="create-game-btn" onclick="startChessGame()">Start Chess Game</button>
                    </div>
                                           
                    <div class="game-card" id="checkersCard">
                        <h3>‚ö´ Checkers Pro</h3>
                        <p>Fast checkers with blockchain stakes! Quick games, instant rewards.</p>
                        <input type="number" class="stake-input" id="checkersStake" placeholder="Enter stake (min 0.01 CORE)" min="0.01" step="0.01">
                        <button class="create-game-btn" onclick="startCheckersGame()">Start Checkers Game</button>
                    </div>

                    <div class="game-card" id="wordCard">
                        <h3>üìù Word Battle</h3>
                        <p>Compete in word games with crypto stakes! Test your vocabulary.</p>
                        <input type="number" class="stake-input" id="wordStake" placeholder="Enter stake (min 0.01 CORE)" min="0.01" step="0.01">
                        <button class="create-game-btn" onclick="startWordGame()">Start Word Game</button>
                    </div>
                    
                    <div class="game-card coming-soon">
                        <h3>‚öîÔ∏è Crypto Kombat</h3>
                        <p>Epic fighting game with NFT characters! Stake tokens and battle for supremacy.</p>
                        <input type="number" class="stake-input" placeholder="Enter stake (min 0.01 CORE)" disabled>
                        <button class="create-game-btn" disabled>Coming Soon</button>
                    </div>
                    
                    <div class="game-card coming-soon">
                        <h3>‚öΩ Block League</h3>
                        <p>FIFA-style soccer with blockchain stakes! Build teams with NFT players.</p>
                        <input type="number" class="stake-input" placeholder="Enter stake (min 0.01 CORE)" disabled>
                        <button class="create-game-btn" disabled>Coming Soon</button>
                    </div>
                </div>
            </div>
            
            <!-- Leaderboard Section -->
            <div id="leaderboardSection" class="hidden">
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="color: #ffd700; margin-bottom: 1rem;">üèÜ Top Players This Week</h3>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #4ecdc4;">
                        <div>
                            <strong>ü•á CryptoKing</strong>
                            <div style="font-size: 0.9rem; color: #4ecdc4;">23 wins ‚Ä¢ 156.7 CORE earned</div>
                        </div>
                        <div style="color: #ffd700; font-weight: bold;">156.7 CORE</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #4ecdc4;">
                        <div>
                            <strong>ü•à BlockMaster</strong>
                            <div style="font-size: 0.9rem; color: #4ecdc4;">19 wins ‚Ä¢ 134.2 CORE earned</div>
                        </div>
                        <div style="color: #ffd700; font-weight: bold;">134.2 CORE</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #4ecdc4;">
                        <div>
                            <strong>ü•â GameWarrior</strong>
                            <div style="font-size: 0.9rem; color: #4ecdc4;">17 wins ‚Ä¢ 98.5 CORE earned</div>
                        </div>
                        <div style="color: #ffd700; font-weight: bold;">98.5 CORE</div>
                    </div>
                    
                    <h3 style="color: #4ecdc4; margin: 2rem 0 1rem 0;">üéØ Recent Matches</h3>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>‚ôüÔ∏è Chess:</strong> CryptoKing vs BlockMaster
                                <div style="font-size: 0.8rem; color: #aaa;">5 minutes ago</div>
                            </div>
                            <div style="color: #00ff88;">Winner: CryptoKing (+2.3 CORE)</div>
                        </div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>‚ö´ Checkers:</strong> GameWarrior vs TokenMaster
                                <div style="font-size: 0.8rem; color: #aaa;">12 minutes ago</div>
                            </div>
                            <div style="color: #00ff88;">Winner: GameWarrior (+1.8 CORE)</div>
                        </div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>üìù Words:</strong> WordWizard vs VocabKing
                                <div style="font-size: 0.8rem; color: #aaa;">18 minutes ago</div>
                            </div>
                            <div style="color: #00ff88;">Winner: WordWizard (+0.9 CORE)</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Section -->
            <div id="profileSection" class="hidden">
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üë§ Player Profile</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px;">
                            <h4>Games Played</h4>
                            <p style="font-size: 2rem; color: #4ecdc4;" id="profileGamesPlayed">0</p>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px;">
                            <h4>Games Won</h4>
                            <p style="font-size: 2rem; color: #00ff88;" id="profileGamesWon">0</p>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px;">
                            <h4>Total Earned</h4>
                            <p style="font-size: 2rem; color: #ffd700;" id="profileTotalEarned">0 CORE</p>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px;">
                            <h4>Win Rate</h4>
                            <p style="font-size: 2rem; color: #ff6b6b;" id="profileWinRate">0%</p>
                        </div>
                    </div>
                    
                    <h4 style="color: #4ecdc4; margin-bottom: 1rem;">üéÆ Game Breakdown</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem;">‚ôüÔ∏è</div>
                            <div><strong>Chess</strong></div>
                            <div style="font-size: 0.9rem; color: #aaa;" id="chessStats">0W / 0L</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem;">‚ö´</div>
                            <div><strong>Checkers</strong></div>
                            <div style="font-size: 0.9rem; color: #aaa;" id="checkersStats">0W / 0L</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem;">üìù</div>
                            <div><strong>Words</strong></div>
                            <div style="font-size: 0.9rem; color: #aaa;" id="wordStats">0W / 0L</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Section -->
           <div id="chatSection" class="hidden">
    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; height: 500px; display: flex; flex-direction: column;">
        <h3 style="margin-bottom: 1rem;">üí¨ Global Chat</h3>
        <div style="flex: 1; overflow-y: auto; margin-bottom: 1rem; padding: 1rem; background: rgba(0, 0, 0, 0.2); border-radius: 8px;" id="chatMessages">
            <div style="margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">
                <strong>CryptoKing:</strong> Just won 2.5 CORE in Chess! üéâ
            </div>
            <div style="margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">
                <strong>GameMaster:</strong> New high stakes game starting soon!
            </div>
            <div style="margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">
                <strong>BlockchainBro:</strong> Anyone up for Word Battle?
            </div>
            <div style="margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">
                <strong>TokenMaster:</strong> Chess game starting! 1 CORE stake üí∞
            </div>
            <div style="margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">
                <strong>WordWizard:</strong> Beat that score! 847 points in Word Battle üìù
            </div>
        </div>
        <div style="display: flex; gap: 0.5rem;">
            <input type="text" style="flex: 1; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; padding: 0.8rem; color: white;" placeholder="Type your message..." id="chatInput" onkeypress="handleChatKeyPress(event)">
            <button style="background: linear-gradient(45deg, #4ecdc4, #44a08d); border: none; padding: 0.8rem 1.5rem; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;" onclick="sendChatMessage()">Send</button>
        </div>
    </div>
</div>

<!-- News Section - REPLACE EXISTING -->
<div id="newsSection" class="hidden">
    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
        <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üì∞ Crypto Breaking News</h3>
        <div id="mainNewsDisplay">
            <div class="news-item">
                <div class="news-title">üöÄ Bitcoin Surges Past $45,000 as Institutional Adoption Grows</div>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">Major financial institutions continue to embrace cryptocurrency as a legitimate asset class, driving unprecedented demand.</p>
                <div class="news-time">2 hours ago ‚Ä¢ CoinDesk</div>
            </div>
            
            <div class="news-item">
                <div class="news-title">‚ö° Ethereum Layer 2 Networks See Record Volume</div>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">Polygon, Arbitrum, and Optimism process over $2B in daily transactions as users seek lower fees.</p>
                <div class="news-time">4 hours ago ‚Ä¢ The Block</div>
            </div>
            
            <div class="news-item">
                <div class="news-title">üéÆ Gaming NFTs Market Explodes with $500M Monthly Volume</div>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">Blockchain gaming platforms like Axie Infinity and Gods Unchained drive massive NFT trading volumes.</p>
                <div class="news-time">6 hours ago ‚Ä¢ NFT Evening</div>
            </div>
            
            <div class="news-item">
                <div class="news-title">üî• DeFi Total Value Locked Reaches New All-Time High</div>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">Decentralized finance protocols now secure over $100 billion in assets across multiple blockchains.</p>
                <div class="news-time">8 hours ago ‚Ä¢ DeFi Pulse</div>
            </div>
        </div>
    </div>
    
    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem;">
        <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üéÆ Gaming Industry News</h3>
        <div class="news-item">
            <div class="news-title">‚öîÔ∏è Blockchain Gaming Revenue Hits $4.6B in 2024</div>
            <p style="margin: 0.5rem 0; font-size: 0.9rem;">Play-to-earn games dominate the gaming landscape with over 1.3 million daily active users across all platforms.</p>
            <div class="news-time">3 hours ago ‚Ä¢ GameFi Today</div>
        </div>
        
        <div class="news-item">
            <div class="news-title">üèÜ Esports Prize Pools Now Include Cryptocurrency</div>
            <p style="margin: 0.5rem 0; font-size: 0.9rem;">Major tournaments offering Bitcoin and Ethereum prizes, with total crypto prizes exceeding $50M this year.</p>
            <div class="news-time">5 hours ago ‚Ä¢ Esports Insider</div>
        </div>
    </div>
</div>

<!-- Settings Section - REPLACE EXISTING -->
<div id="settingsSection" class="hidden">
    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem;">
        <h3 style="margin-bottom: 1rem;">‚öôÔ∏è Platform Settings</h3>
        
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
            <div>
                <strong>Sound Effects</strong>
                <div style="font-size: 0.9rem; color: #aaa;">Game sounds and notifications</div>
            </div>
            <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
            </div>
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
            <div>
                <strong>Chat Notifications</strong>
                <div style="font-size: 0.9rem; color: #aaa;">Global chat message alerts</div>
            </div>
            <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
            </div>
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
            <div>
                <strong>High Stakes Warnings</strong>
                <div style="font-size: 0.9rem; color: #aaa;">Confirm games over 1 CORE</div>
            </div>
            <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
            </div>
        </div>
    </div>
    
    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem;">
        <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üîß Smart Contract Settings</h3>
        
        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
            <strong>Contract Address:</strong>
            <div style="font-family: monospace; font-size: 0.9rem; color: #4ecdc4; margin-top: 0.5rem;">0x1234567890abcdef1234567890abcdef12345678</div>
            <div style="font-size: 0.8rem; color: #00ff88; margin-top: 0.3rem;">‚úÖ Verified on Core Blockchain</div>
        </div>
        
        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
            <strong>Network Status:</strong>
            <div style="margin-top: 0.5rem; color: #00ff88;">üü¢ Core Blockchain - Connected</div>
            <div style="font-size: 0.9rem; color: #aaa;">Block: 1,234,567 | Gas: 15 GWEI</div>
        </div>
    </div>
</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                        <div>
                            <strong>Chat Notifications</strong>
                            <div style="font-size: 0.9rem; color: #aaa;">Global chat message alerts</div>
                        </div>
                        <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                        <div>
                            <strong>Auto-Connect Wallet</strong>
                            <div style="font-size: 0.9rem; color: #aaa;">Remember wallet for future sessions</div>
                        </div>
                        <div class="toggle-switch" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: rgba(255, 255, 255, 0.2); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="position: absolute; top: 3px; left: 3px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                        <div>
                            <strong>High Stakes Warnings</strong>
                            <div style="font-size: 0.9rem; color: #aaa;">Confirm games over 1 CORE</div>
                        </div>
                        <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                        <div>
                            <strong>Transaction Confirmations</strong>
                            <div style="font-size: 0.9rem; color: #aaa;">Show blockchain transaction status</div>
                        </div>
                        <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                        <div>
                            <strong>Live News Updates</strong>
                            <div style="font-size: 0.9rem; color: #aaa;">Real-time crypto news feed</div>
                        </div>
                        <div class="toggle-switch active" onclick="toggleSetting(this)" style="position: relative; width: 60px; height: 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="position: absolute; top: 3px; left: 33px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: all 0.3s ease;"></div>
                        </div>
                    </div>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem;">
                    <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üîß Smart Contract Settings</h3>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <strong>Contract Address:</strong>
                        <div style="font-family: monospace; font-size: 0.9rem; color: #4ecdc4; margin-top: 0.5rem;">0x1234567890abcdef1234567890abcdef12345678</div>
                        <div style="font-size: 0.8rem; color: #00ff88; margin-top: 0.3rem;">‚úÖ Verified on Core Blockchain</div>
                    </div>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <strong>Gas Settings:</strong>
                        <div style="margin-top: 0.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem;">Gas Price (GWEI):</label>
                            <input type="number" style="width: 100%; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 5px; padding: 0.5rem; color: white;" value="20" min="1" max="100">
                        </div>
                    </div>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                        <strong>Network Status:</strong>
                        <div style="margin-top: 0.5rem; color: #00ff88;">üü¢ Core Blockchain - Connected</div>
                        <div style="font-size: 0.9rem; color: #aaa;">Block: 1,234,567 | Gas: 15 GWEI</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let provider = null;
        let signer = null;
        let userAddress = null;
        let currentSection = 'games';
        let gameContract = null;
        let ageVerified = false;
        let kycCompleted = false;
        let windowZIndex = 1000;
        let openWindows = [];
        
        // Smart Contract ABI (simplified for demo)
        const CONTRACT_ABI = [
            "function createGame(uint8 gameType, uint256 stake) external payable",
            "function joinGame(uint256 gameId) external payable",
            "function makeMove(uint256 gameId, string memory move) external",
            "function declareWinner(uint256 gameId, address winner) external",
            "function getGameInfo(uint256 gameId) external view returns (tuple(address player1, address player2, uint256 stake, uint8 gameType, uint8 status))",
            "event GameCreated(uint256 indexed gameId, address indexed creator, uint8 gameType, uint256 stake)",
            "event GameJoined(uint256 indexed gameId, address indexed joiner)",
            "event MoveMade(uint256 indexed gameId, address indexed player, string move)",
            "event GameEnded(uint256 indexed gameId, address indexed winner, uint256 prize)"
        ];
        
        const CONTRACT_ADDRESS = "0x1234567890abcdef1234567890abcdef12345678"; // Demo address
        
        // Game state variables
        let currentGame = null;
        let chessBoard = [];
        let checkersBoard = [];
        let selectedSquare = null;
        let currentPlayer = 'white';
        let gameId = null;
        

        // ====== ADD THE WINDOW MANAGEMENT FUNCTIONS HERE ======
    // Proper game window management functions
    function openGameWindow(gameType) {
        const gameWindow = document.getElementById(gameType + 'GameWindow');
        const overlay = document.getElementById('gameOverlay');
        
        // Increment z-index for new windows
        windowZIndex += 10;
        gameWindow.style.zIndex = windowZIndex;
        
        // Add to open windows array
        if (!openWindows.includes(gameType)) {
            openWindows.push(gameType);
        }
        
        // Stagger position based on number of open windows
        const offset = openWindows.indexOf(gameType) * 30;
        gameWindow.style.top = `calc(50% + ${offset}px)`;
        gameWindow.style.left = `calc(50% + ${offset}px)`;
        
        gameWindow.classList.remove('hidden', 'minimized');
        overlay.classList.remove('hidden');
        
        // Initialize game if not already done
        if (gameType === 'chess' && chessBoard.length === 0) {
            initializeChessBoard();
        } else if (gameType === 'checkers' && checkersBoard.length === 0) {
            initializeCheckersBoard();
        } else if (gameType === 'word' && currentWordRound === 0) {
            startWordRound();
        }
        
        // Event handlers
        overlay.onclick = () => closeGame(gameType);
        gameWindow.onclick = (e) => {
            if (gameWindow.classList.contains('minimized')) {
                restoreGame(gameType);
                e.stopPropagation();
            } else {
                // Bring to front when clicked
                windowZIndex += 10;
                gameWindow.style.zIndex = windowZIndex;
            }
        };
    }

    function closeGame(gameType) {
        const gameWindow = document.getElementById(gameType + 'GameWindow');
        const overlay = document.getElementById('gameOverlay');
        
        if (confirm('Are you sure you want to close this game?')) {
            gameWindow.classList.add('hidden');
            
            // Remove from open windows
            openWindows = openWindows.filter(window => window !== gameType);
            
            // Hide overlay if no windows open
            if (openWindows.length === 0) {
                overlay.classList.add('hidden');
            }
            
            // Reset game state and clear stake input
            if (gameType === 'chess') {
                selectedSquare = null;
                currentPlayer = 'white';
            } else if (gameType === 'checkers') {
                currentPlayer = 'red';
            } else if (gameType === 'word') {
                currentWordRound = 1;
                playerScore = 0;
                opponentScore = 0;
            }
            
            document.getElementById(gameType + 'Stake').value = '';
            showTransactionStatus('Game closed');
        }
    }
    // ====== END OF WINDOW MANAGEMENT FUNCTIONS ======
    
        // Player stats (stored locally for demo)
        let playerStats = {
            gamesPlayed: 0,
            gamesWon: 0,
            totalEarned: 0,
            chess: { wins: 0, losses: 0 },
            checkers: { wins: 0, losses: 0 },
            words: { wins: 0, losses: 0 }
        };
        
        // Mobile menu toggle
        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('active');
        }
        
        // Navigation
        function showSection(section) {
            // Hide all sections
            const sections = ['gamesSection', 'leaderboardSection', 'profileSection', 'chatSection', 'newsSection', 'settingsSection'];
            sections.forEach(s => document.getElementById(s).classList.add('hidden'));
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentSection = section;
            
            // Close mobile menu
            document.getElementById('navMenu').classList.remove('active');
            
            // Update profile stats when viewing profile
            if (section === 'profile') {
                updateProfileDisplay();
            }
        }
        
        // Show transaction status
        function showTransactionStatus(message, txHash = '') {
            const statusDiv = document.getElementById('transactionStatus');
            const messageDiv = document.getElementById('txStatusMessage');
            const hashDiv = document.getElementById('txHash');
            
            messageDiv.textContent = message;
            if (txHash) {
                hashDiv.textContent = `TX: ${txHash.substring(0, 10)}...${txHash.substring(56)}`;
            } else {
                hashDiv.textContent = '';
            }
            
            statusDiv.classList.add('show');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 5000);
        }
        
        // Wallet connection
        document.getElementById('connectBtn').addEventListener('click', async () => {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('Please install MetaMask or Core Wallet to play!');
                    return;
                }
                
                showTransactionStatus('Connecting wallet...');
                
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length > 0) {
                    userAddress = accounts[0];
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    signer = provider.getSigner();
                    
                    // Initialize smart contract
                    gameContract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
                    
                    // Update UI
                    document.getElementById('connectionStatus').innerHTML = 
                        `üü¢ ${userAddress.substring(0, 6)}...${userAddress.substring(38)}`;
                    document.getElementById('connectBtn').classList.add('hidden');
                    document.getElementById('disconnectBtn').classList.remove('hidden');
                    
                    // Update balance
                    const balance = await provider.getBalance(userAddress);
                    const balanceInCore = ethers.utils.formatEther(balance);
                    document.getElementById('balanceDisplay').textContent = 
                        parseFloat(balanceInCore).toFixed(4) + ' CORE';
                    
                    showTransactionStatus('‚úÖ Wallet connected successfully!');
                    
                    // Listen for contract events
                    setupContractListeners();
                } else {
                    throw new Error('No accounts returned from wallet');
                }
                
            } catch (error) {
                console.error('Error connecting wallet:', error);
                showTransactionStatus('‚ùå Error connecting wallet: ' + error.message);
            }
        });
        
        // Wallet disconnection
        document.getElementById('disconnectBtn').addEventListener('click', () => {
            userAddress = null;
            provider = null;
            signer = null;
            gameContract = null;
            
            // Reset UI
            document.getElementById('connectionStatus').innerHTML = 'üî¥ Not Connected';
            document.getElementById('balanceDisplay').textContent = '0.00 CORE';
            document.getElementById('connectBtn').classList.remove('hidden');
            document.getElementById('disconnectBtn').classList.add('hidden');
            
            showTransactionStatus('üëã Wallet disconnected');
        });
        
        // Setup contract event listeners
        function setupContractListeners() {
            if (!gameContract) return;
            
            gameContract.on('GameCreated', (gameId, creator, gameType, stake) => {
                console.log('Game created:', gameId.toString(), creator, gameType, stake.toString());
                addChatMessage('System', `üéÆ New game created! ID: ${gameId.toString()}`);
            });
            
            gameContract.on('GameJoined', (gameId, joiner) => {
                console.log('Game joined:', gameId.toString(), joiner);
                addChatMessage('System', `üéØ Player joined game ${gameId.toString()}!`);
            });
            
            gameContract.on('MoveMade', (gameId, player, move) => {
                console.log('Move made:', gameId.toString(), player, move);
                // Handle move in UI
            });
            
            gameContract.on('GameEnded', (gameId, winner, prize) => {
                console.log('Game ended:', gameId.toString(), winner, prize.toString());
                const prizeInCore = ethers.utils.formatEther(prize);
                addChatMessage('System', `üèÜ Game ${gameId.toString()} won! Prize: ${prizeInCore} CORE`);
                
                // Update player stats if they won
                if (winner.toLowerCase() === userAddress.toLowerCase()) {
                    playerStats.gamesWon++;
                    playerStats.totalEarned += parseFloat(prizeInCore);
                    updateProfileDisplay();
                }
            });
        }

        // Game window management
        // function openGameWindow(gameType) {
        //     const gameWindow = document.getElementById(gameType + 'GameWindow');
        //     const overlay = document.getElementById('gameOverlay');
            
        //     gameWindow.classList.remove('hidden', 'minimized');
        //     overlay.classList.remove('hidden');
            
        //     overlay.onclick = () => closeGame(gameType);
        //     gameWindow.onclick = (e) => {
        //         if (gameWindow.classList.contains('minimized')) {
        //             restoreGame(gameType);
        //             e.stopPropagation();
        //         }
        //     };
        // }

        function minimizeGame(gameType) {
            const gameWindow = document.getElementById(gameType + 'GameWindow');
            const overlay = document.getElementById('gameOverlay');
            
            gameWindow.classList.add('minimized');
            overlay.classList.add('hidden');
        }

        function restoreGame(gameType) {
            const gameWindow = document.getElementById(gameType + 'GameWindow');
            const overlay = document.getElementById('gameOverlay');
            
            gameWindow.classList.remove('minimized');
            overlay.classList.remove('hidden');
        }

        function closeGame(gameType) {
            const gameWindow = document.getElementById(gameType + 'GameWindow');
            const overlay = document.getElementById('gameOverlay');
            
            if (confirm('Are you sure you want to close this game?')) {
                gameWindow.classList.add('hidden');
                overlay.classList.add('hidden');
                
                if (gameType === 'chess') {
                    selectedSquare = null;
                    currentPlayer = 'white';
                } else if (gameType === 'checkers') {
                    currentPlayer = 'red';
                } else if (gameType === 'word') {
                    currentWordRound = 1;
                    playerScore = 0;
                    opponentScore = 0;
                }
                
                document.getElementById(gameType + 'Stake').value = '';
                showTransactionStatus('Game closed');
            }
        }
        
        // Chess game functions
        function initializeChessBoard() {
            chessBoard = [
                ['r','n','b','q','k','b','n','r'],
                ['p','p','p','p','p','p','p','p'],
                [null,null,null,null,null,null,null,null],
                [null,null,null,null,null,null,null,null],
                [null,null,null,null,null,null,null,null],
                [null,null,null,null,null,null,null,null],
                ['P','P','P','P','P','P','P','P'],
                ['R','N','B','Q','K','B','N','R']
            ];
            
            const boardElement = document.getElementById('chessBoard');
            boardElement.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `chess-square ${(row + col) % 2 === 0 ? 'white' : 'black'}`;
                    square.dataset.row = row;
                    square.dataset.col = col;
                    square.onclick = () => handleChessClick(row, col);
                    
                    const piece = chessBoard[row][col];
                    if (piece) {
                        square.textContent = getChessPieceSymbol(piece);
                    }
                    
                    boardElement.appendChild(square);
                }
            }
        }
        
        function getChessPieceSymbol(piece) {
            const symbols = {
                'K': '‚ôî', 'Q': '‚ôï', 'R': '‚ôñ', 'B': '‚ôó', 'N': '‚ôò', 'P': '‚ôô',
                'k': '‚ôö', 'q': '‚ôõ', 'r': '‚ôú', 'b': '‚ôù', 'n': '‚ôû', 'p': '‚ôü'
            };
            return symbols[piece] || '';
        }
        
        function handleChessClick(row, col) {
            const square = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            
            if (selectedSquare) {
                // Clear previous selection
                document.querySelectorAll('.chess-square').forEach(s => {
                    s.classList.remove('selected', 'possible-move');
                });
                
                // Make move if valid
                if (isValidChessMove(selectedSquare.row, selectedSquare.col, row, col)) {
                    makeChessMove(selectedSquare.row, selectedSquare.col, row, col);
                }
                selectedSquare = null;
            } else {
                // Select piece
                const piece = chessBoard[row][col];
                if (piece && isPlayerPiece(piece, currentPlayer)) {
                    selectedSquare = { row, col };
                    square.classList.add('selected');
                    highlightPossibleMoves(row, col);
                }
            }
        }
        
        function isPlayerPiece(piece, player) {
            if (player === 'white') {
                return piece === piece.toUpperCase();
            } else {
                return piece === piece.toLowerCase();
            }
        }
        
        function isValidChessMove(fromRow, fromCol, toRow, toCol) {
            // Simplified chess validation (basic rules)
            const piece = chessBoard[fromRow][fromCol];
            const targetPiece = chessBoard[toRow][toCol];
            
            // Can't capture own piece
            if (targetPiece && isPlayerPiece(targetPiece, currentPlayer)) {
                return false;
            }
            
            // Basic pawn movement
            if (piece.toLowerCase() === 'p') {
                const direction = piece === 'P' ? -1 : 1;
                const startRow = piece === 'P' ? 6 : 1;
                
                // Forward move
                if (fromCol === toCol && !targetPiece) {
                    if (toRow === fromRow + direction) return true;
                    if (fromRow === startRow && toRow === fromRow + 2 * direction) return true;
                }
                
                // Diagonal capture
                if (Math.abs(fromCol - toCol) === 1 && toRow === fromRow + direction && targetPiece) {
                    return true;
                }
            }
            
            // Add more piece-specific rules here...
            return true; // Simplified - allow most moves for demo
        }
        
        function makeChessMove(fromRow, fromCol, toRow, toCol) {
            const piece = chessBoard[fromRow][fromCol];
            chessBoard[toRow][toCol] = piece;
            chessBoard[fromRow][fromCol] = null;
            
            // Update display
            initializeChessBoard();
            
            // Switch players
            currentPlayer = currentPlayer === 'white' ? 'black' : 'white';
            document.getElementById('chessStatus').textContent = `${currentPlayer}'s turn`;
            
            // Send move to smart contract (if in real game)
            if (gameId && gameContract) {
                const moveString = `${fromRow},${fromCol},${toRow},${toCol}`;
                sendMoveToContract(gameId, moveString);
            }
        }
        
        function highlightPossibleMoves(row, col) {
            // Simplified - highlight adjacent squares for demo
            for (let r = Math.max(0, row-1); r <= Math.min(7, row+1); r++) {
                for (let c = Math.max(0, col-1); c <= Math.min(7, col+1); c++) {
                    if (r !== row || c !== col) {
                        const square = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
                        if (square) square.classList.add('possible-move');
                    }
                }
            }
        }
        
        async function startChessGame() {
    if (!userAddress) {
        alert('Please connect your wallet first!');
        return;
    }
    
    const stakeAmount = parseFloat(document.getElementById('chessStake').value);
    if (!stakeAmount || stakeAmount < 0.01) {
        alert('Please enter a valid stake amount (minimum 0.01 CORE)');
        return;
    }
    
    try {
        showTransactionStatus('Creating chess game...');
        
        const stakeWei = ethers.utils.parseEther(stakeAmount.toString());
        const tx = await gameContract.createGame(0, stakeWei, { value: stakeWei });
        
        showTransactionStatus('‚è≥ Transaction submitted...', tx.hash);
        const receipt = await tx.wait();
        
        // Open game window instead of showing inline
        openGameWindow('chess');
        document.getElementById('chessStatus').textContent = 'Waiting for opponent...';
        initializeChessBoard();
        
        playerStats.gamesPlayed++;
        updateProfileDisplay();
        
        showTransactionStatus('‚úÖ Chess game created successfully!');
        
    } catch (error) {
        console.error('Error creating chess game:', error);
        showTransactionStatus('‚ùå Error creating game: ' + error.message);
    }
}

        // Checkers game functions
        function initializeCheckersBoard() {
            checkersBoard = Array(8).fill().map(() => Array(8).fill(null));
            
            // Set up initial pieces
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    if ((row + col) % 2 === 1) { // Dark squares only
                        if (row < 3) {
                            checkersBoard[row][col] = 'red';
                        } else if (row > 4) {
                            checkersBoard[row][col] = 'black';
                        }
                    }
                }
            }
            
            const boardElement = document.getElementById('checkersBoard');
            boardElement.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `checkers-square ${(row + col) % 2 === 0 ? 'light' : 'dark'}`;
                    square.dataset.row = row;
                    square.dataset.col = col;
                    square.onclick = () => handleCheckersClick(row, col);
                    
                    const piece = checkersBoard[row][col];
                    if (piece) {
                        const pieceDiv = document.createElement('div');
                        pieceDiv.className = `checker-piece ${piece}-piece`;
                        square.appendChild(pieceDiv);
                    }
                    
                    boardElement.appendChild(square);
                }
            }
        }
        
        function handleCheckersClick(row, col) {
            // Simplified checkers logic for demo
            const piece = checkersBoard[row][col];
            if (piece && piece === currentPlayer) {
                // Select piece and show possible moves
                document.querySelectorAll('.checkers-square').forEach(s => s.classList.remove('selected'));
                const square = document.querySelector(`.checkers-square[data-row="${row}"][data-col="${col}"]`);
                square.classList.add('selected');
            }
        }
        
        async function startCheckersGame() {
    if (!userAddress) {
        alert('Please connect your wallet first!');
        return;
    }
    
    const stakeAmount = parseFloat(document.getElementById('checkersStake').value);
    if (!stakeAmount || stakeAmount < 0.01) {
        alert('Please enter a valid stake amount (minimum 0.01 CORE)');
        return;
    }
    
    try {
        showTransactionStatus('Creating checkers game...');
        
        const stakeWei = ethers.utils.parseEther(stakeAmount.toString());
        const tx = await gameContract.createGame(1, stakeWei, { value: stakeWei });
        
        showTransactionStatus('‚è≥ Transaction submitted...', tx.hash);
        await tx.wait();
        
        // Open game window instead of showing inline
        openGameWindow('checkers');
        document.getElementById('checkersStatus').textContent = 'Waiting for opponent...';
        initializeCheckersBoard();
        
        playerStats.gamesPlayed++;
        updateProfileDisplay();
        
        showTransactionStatus('‚úÖ Checkers game created!');
        
    } catch (error) {
        console.error('Error creating checkers game:', error);
        showTransactionStatus('‚ùå Error: ' + error.message);
    }
}
        
        // Word Battle game functions
        const wordPrompts = [
            { letters: "BLOCKCHAIN", category: "Technology" },
            { letters: "CRYPTICUS", category: "Gaming" },
            { letters: "ETHEREUM", category: "Cryptocurrency" },
            { letters: "SMARTCONTRACT", category: "DeFi" },
            { letters: "DECENTRALIZED", category: "Web3" }
        ];
        
        let currentWordRound = 1;
        let playerScore = 0;
        let opponentScore = 0;
        let currentPrompt = null;
        
        async function startWordGame() {
    if (!userAddress) {
        alert('Please connect your wallet first!');
        return;
    }
    
    const stakeAmount = parseFloat(document.getElementById('wordStake').value);
    if (!stakeAmount || stakeAmount < 0.01) {
        alert('Please enter a valid stake amount (minimum 0.01 CORE)');
        return;
    }
    
    try {
        showTransactionStatus('Creating word game...');
        
        const stakeWei = ethers.utils.parseEther(stakeAmount.toString());
        const tx = await gameContract.createGame(2, stakeWei, { value: stakeWei });
        
        showTransactionStatus('‚è≥ Transaction submitted...', tx.hash);
        await tx.wait();
        
        // Open game window instead of showing inline
        openGameWindow('word');
        startWordRound();
        
        playerStats.gamesPlayed++;
        updateProfileDisplay();
        
        showTransactionStatus('‚úÖ Word game created!');
        
    } catch (error) {
        console.error('Error creating word game:', error);
        showTransactionStatus('‚ùå Error: ' + error.message);
    }
}
        
        function startWordRound() {
            currentPrompt = wordPrompts[Math.floor(Math.random() * wordPrompts.length)];
            document.getElementById('wordStatus').textContent = `Round ${currentWordRound} of 3`;
            document.getElementById('wordPrompt').textContent = `Make a word with these letters:`;
            document.getElementById('wordLetters').textContent = currentPrompt.letters;
            document.getElementById('wordInput').value = '';
            document.getElementById('playerScore').textContent = playerScore;
            document.getElementById('opponentScore').textContent = opponentScore;
        }
        
        function submitWord() {
    const word = document.getElementById('wordInput').value.toUpperCase().trim();
    if (!word) {
        alert('Please enter a word!');
        return;
    }
            
            // Simple validation - check if word uses only available letters
            const availableLetters = currentPrompt.letters.split('');
            const wordLetters = word.split('');
            
            let isValid = true;
            const usedLetters = [...availableLetters];
            
            for (let letter of wordLetters) {
                const index = usedLetters.indexOf(letter);
                if (index === -1) {
                    isValid = false;
                    break;
                }
                usedLetters.splice(index, 1);
            }
            
            if (!isValid) {
                alert('Invalid word! Use only the available letters.');
                return;
            }
            
            // Calculate score
            let wordScore = word.length * 10;
            if (word.length >= 6) wordScore += 20; // Bonus for long words
            
            playerScore += wordScore;
            opponentScore += Math.floor(Math.random() * 80) + 40; // Simulated opponent
            
            addChatMessage('You', `Made word: ${word} (${wordScore} points)`);
            
            currentWordRound++;
            if (currentWordRound <= 3) {
                setTimeout(startWordRound, 1500);
            } else {
                endWordGame();
            }
        }
        
        function skipRound() {
            opponentScore += Math.floor(Math.random() * 60) + 30;
            currentWordRound++;
            if (currentWordRound <= 3) {
                setTimeout(startWordRound, 1000);
            } else {
                endWordGame();
            }
        }
        
        function endWordGame() {
            const winner = playerScore > opponentScore ? 'You' : 'Opponent';
            document.getElementById('wordStatus').textContent = 
                `Game Over! ${winner} wins! Final: ${playerScore} - ${opponentScore}`;
            
            if (winner === 'You') {
                playerStats.gamesWon++;
                playerStats.words.wins++;
                addChatMessage('System', 'üèÜ You won the Word Battle!');
            } else {
                playerStats.words.losses++;
            }
            
            updateProfileDisplay();
        }
        
        // Utility functions
        function resignChess() {
    if (confirm('Are you sure you want to resign?')) {
        document.getElementById('chessStatus').textContent = 'Game resigned';
        playerStats.chess.losses++;
        updateProfileDisplay();
        addChatMessage('System', 'Chess game resigned');
        
        // Close the game window after a short delay
        setTimeout(() => {
            closeGame('chess');
        }, 2000);
    }
}
        
        function drawChess() {
            alert('Draw offer sent to opponent');
        }
        
        function resignCheckers() {
    if (confirm('Are you sure you want to resign?')) {
        document.getElementById('checkersStatus').textContent = 'Game resigned';
        playerStats.checkers.losses++;
        updateProfileDisplay();
        addChatMessage('System', 'Checkers game resigned');
        
        // Close the game window after a short delay
        setTimeout(() => {
            closeGame('checkers');
        }, 2000);
    }
}
        
        async function sendMoveToContract(gameId, move) {
            try {
                if (gameContract) {
                    const tx = await gameContract.makeMove(gameId, move);
                    await tx.wait();
                }
            } catch (error) {
                console.error('Error sending move:', error);
            }
        }
        
        function updateProfileDisplay() {
            document.getElementById('profileGamesPlayed').textContent = playerStats.gamesPlayed;
            document.getElementById('profileGamesWon').textContent = playerStats.gamesWon;
            document.getElementById('profileTotalEarned').textContent = playerStats.totalEarned.toFixed(4) + ' CORE';
            
            const winRate = playerStats.gamesPlayed > 0 ? 
                ((playerStats.gamesWon / playerStats.gamesPlayed) * 100).toFixed(1) : 0;
            document.getElementById('profileWinRate').textContent = winRate + '%';
            
            document.getElementById('chessStats').textContent = 
                `${playerStats.chess.wins}W / ${playerStats.chess.losses}L`;
            document.getElementById('checkersStats').textContent = 
                `${playerStats.checkers.wins}W / ${playerStats.checkers.losses}L`;
            document.getElementById('wordStats').textContent = 
                `${playerStats.words.wins}W / ${playerStats.words.losses}L`;
        }
        
        // Chat functionality
        function addChatMessage(user, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = 'margin-bottom: 0.8rem; padding: 0.5rem; border-radius: 8px; background: rgba(255, 255, 255, 0.05);';
            messageDiv.innerHTML = `<strong>${user}:</strong> ${message}`;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            while (chatMessages.children.length > 50) {
                chatMessages.removeChild(chatMessages.firstChild);
            }
        }
        
        function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            if (!userAddress) {
                alert('Please connect your wallet to chat!');
                return;
            }
            
            addChatMessage('You', message);
            chatInput.value = '';
            
            // Simulate responses
            setTimeout(() => {
                const responses = [
                    "Nice! Good luck with your games! üéÆ",
                    "Welcome to Crypticus! Ready to win some CORE? üí∞",
                    "Great to see another player! Let's compete! ‚öîÔ∏è",
                    "The blockchain gaming revolution is here! üöÄ",
                    "Just finished an epic chess match! ‚ôüÔ∏è",
                    "Word Battle is so addictive! üìù"
                ];
                const randomUser = ['CryptoKing', 'GameMaster', 'BlockchainBro', 'TokenMaster', 'WordWizard'][Math.floor(Math.random() * 5)];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage(randomUser, randomResponse);
            }, 2000);
        }
        
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }
        
        // Settings toggle
        function toggleSetting(element) {
            const isActive = element.classList.contains('active');
            const toggleDot = element.querySelector('div');
            
            if (isActive) {
                element.classList.remove('active');
                element.style.background = 'rgba(255, 255, 255, 0.2)';
                toggleDot.style.left = '3px';
            } else {
                element.classList.add('active');
                element.style.background = 'linear-gradient(45deg, #4ecdc4, #44a08d)';
                toggleDot.style.left = '33px';
            }
        }
        
                // Age verification
        function verifyAge(isAdult) {
            if (isAdult) {
                document.getElementById('ageVerificationModal').style.display = 'none';
                sessionStorage.setItem('ageVerified', 'true');
                showTransactionStatus('‚úÖ Age verified. Welcome to Crypticus!');
            } else {
                alert('Sorry, you must be 18 or older to use this platform.');
                window.location.href = 'https://www.google.com';
            }
        }
        
        // Show age verification on first visit
        function checkAgeVerification() {
            const ageVerified = sessionStorage.getItem('ageVerified');
            if (!ageVerified) {
                document.getElementById('ageVerificationModal').style.display = 'flex';
            }
        }
        
        // Enhanced wallet connection with KYC check
        const originalConnectWallet = document.getElementById('connectBtn').onclick;
        document.getElementById('connectBtn').onclick = function() {
            const ageVerified = sessionStorage.getItem('ageVerified');
            if (!ageVerified) {
                alert('Please verify your age first.');
                document.getElementById('ageVerificationModal').style.display = 'flex';
                return;
            }
            // Continue with wallet connection
            originalConnectWallet();
        };
        
        // Terms and conditions modal
        function showTerms() {
            const termsContent = `
            <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 1rem;">
                <div style="background: #1a1a2e; border: 2px solid #4ecdc4; border-radius: 15px; padding: 2rem; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                    <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üìú Terms & Conditions</h3>
                    <div style="color: white; font-size: 0.9rem; line-height: 1.6;">
                        <h4>üîû Age Requirement</h4>
                        <p>Users must be 18 years or older to participate in gaming activities.</p>
                        
                        <h4>üéÆ Gaming Nature</h4>
                        <p>Crypticus offers skill-based games including chess, checkers, and word games.</p>
                        
                        <h4>üí∞ Financial Responsibility</h4>
                        <p>Players are responsible for tax compliance in their jurisdiction.</p>
                        
                        <h4>üõ°Ô∏è Responsible Gaming</h4>
                        <p>We promote responsible gaming. Set limits and play within your means.</p>
                        
                        <h4>‚öñÔ∏è Legal Compliance</h4>
                        <p>Platform operates under applicable gaming regulations.</p>
                        
                        <h4>üîê Privacy & Security</h4>
                        <p>We protect user data and ensure secure transactions.</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: #4ecdc4; color: white; border: none; padding: 1rem 2rem; border-radius: 8px; margin-top: 1rem; cursor: pointer;">Close</button>
                </div>
            </div>`;
            document.body.insertAdjacentHTML('beforeend', termsContent);
        }
        
        // Initialize age verification on page load
        document.addEventListener('DOMContentLoaded', () => {
            checkAgeVerification();
        });
        
        // Auto-update functions
        function updateGameFeed() {
            const feedMessages = [
                "üéÆ Active Games: " + (Math.floor(Math.random() * 20) + 5),
                "üí∞ Total Pool: " + (Math.random() * 500 + 100).toFixed(1) + " CORE",
                "üèÜ Last Winner: " + ['CryptoKing', 'GameMaster', 'BlockchainBro', 'TokenMaster'][Math.floor(Math.random() * 4)],
                "‚ö° New high score in Word Battle!",
                "üî• Epic chess match in progress!",
                "üíé Checkers tournament starting soon!"
            ];
            
            const gameFeed = document.getElementById('gameFeed');
            if (gameFeed) {
                gameFeed.innerHTML = '';
                feedMessages.slice(0, 3).forEach((message, index) => {
                    const feedDiv = document.createElement('div');
                    feedDiv.className = 'news-item';
                    feedDiv.innerHTML = `
                        <div class="news-title">${message}</div>
                        <div class="news-time">${index * 5 + 2} minutes ago</div>
                    `;
                    gameFeed.appendChild(feedDiv);
                });
            }
        }
        
        function addRandomChatMessage() {
            const messages = [
                { user: "StakeHero", message: "Just won big in Checkers! üéâ" },
                { user: "WordWizard", message: "Word Battle high score: 847! üìù" },
                { user: "ChessMaster", message: "Looking for a chess opponent! ‚ôüÔ∏è" },
                { user: "CryptoGamer", message: "These games are incredible! üöÄ" },
                { user: "BlockchainBro", message: "Best gaming platform ever! üí∞" },
                { user: "TokenTitan", message: "Just earned 5 CORE! üèÜ" }
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            addChatMessage(randomMessage.user, randomMessage.message);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Crypticus blockchain gaming platform loaded!');
            
            // Update game feed every 20 seconds
            updateGameFeed();
            setInterval(updateGameFeed, 20000);
            
            // Add chat messages every 25 seconds
            setInterval(addRandomChatMessage, 25000);
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
    const navMenu = document.getElementById('navMenu');
    const mobileBtn = document.querySelector('.mobile-menu-btn');
    
    if (!navMenu.contains(e.target) && 
        e.target !== mobileBtn &&
        navMenu.classList.contains('active')) {
        navMenu.classList.remove('active');
    }
});
            
            // Auto-hide transaction status on click
            document.getElementById('transactionStatus').addEventListener('click', () => {
                document.getElementById('transactionStatus').classList.remove('show');
            });
        });
        // Active games management
let activeGames = [
    { id: 1, type: 'chess', creator: 'CryptoKing', stake: 0.5, status: 'waiting' },
    { id: 2, type: 'checkers', creator: 'GameMaster', stake: 0.3, status: 'waiting' },
    { id: 3, type: 'words', creator: 'WordWizard', stake: 0.8, status: 'waiting' }
];

// Update active games display
function updateActiveGames() {
    const gamesList = document.getElementById('activeGamesList');
    const noGamesDiv = document.getElementById('noActiveGames');
    
    if (activeGames.length === 0) {
        gamesList.innerHTML = '';
        noGamesDiv.classList.remove('hidden');
        return;
    }
    
    noGamesDiv.classList.add('hidden');
    gamesList.innerHTML = '';
    
    activeGames.forEach(game => {
        const gameDiv = document.createElement('div');
        gameDiv.className = 'game-lobby-item';
        
        const gameIcon = game.type === 'chess' ? '‚ôüÔ∏è' : game.type === 'checkers' ? '‚ö´' : 'üìù';
        const gameName = game.type === 'chess' ? 'Chess Masters' : game.type === 'checkers' ? 'Checkers Pro' : 'Word Battle';
        
        gameDiv.innerHTML = `
            <div>
                <strong>${gameIcon} ${gameName}</strong>
                <div style="font-size: 0.9rem; color: #aaa;">${game.creator} ‚Ä¢ Stake: ${game.stake} CORE</div>
            </div>
            <button class="join-game-btn" onclick="joinGame('${game.type}', '${game.id}', ${game.stake})">Join Game</button>
        `;
        
        gamesList.appendChild(gameDiv);
    });
}

// Join existing game
async function joinGame(gameType, gameId, stake) {
    if (!userAddress) {
        alert('Please connect your wallet first!');
        return;
    }
    
    try {
        showTransactionStatus('Joining game...');
        
        const stakeWei = ethers.utils.parseEther(stake.toString());
        const tx = await gameContract.joinGame(gameId, { value: stakeWei });
        
        showTransactionStatus('‚è≥ Joining game...', tx.hash);
        await tx.wait();
        
        // Remove from active games and start the game
        activeGames = activeGames.filter(game => game.id != gameId);
        updateActiveGames();
        
        // Open game window
        openGameWindow(gameType);
        
        if (gameType === 'chess') {
            document.getElementById('chessStatus').textContent = 'Game started! Your turn.';
            initializeChessBoard();
        } else if (gameType === 'checkers') {
            document.getElementById('checkersStatus').textContent = 'Game started! Your turn.';
            initializeCheckersBoard();
        } else if (gameType === 'words') {
            document.getElementById('wordStatus').textContent = 'Game started! Round 1 of 3';
            startWordRound();
        }
        
        playerStats.gamesPlayed++;
        updateProfileDisplay();
        
        showTransactionStatus('‚úÖ Joined game successfully!');
        addChatMessage('System', `üéÆ ${userAddress.substring(0, 6)}... joined ${gameType} game!`);
        
    } catch (error) {
        console.error('Error joining game:', error);
        showTransactionStatus('‚ùå Error joining game: ' + error.message);
    }
}

// Enhanced game window management with better stacking
// let windowZIndex = 1000;
// let openWindows = [];

function openGameWindow(gameType) {
    const gameWindow = document.getElementById(gameType + 'GameWindow');
    const overlay = document.getElementById('gameOverlay');
    
    // Increment z-index for new windows
    windowZIndex += 10;
    gameWindow.style.zIndex = windowZIndex;
    
    // Add to open windows array
    if (!openWindows.includes(gameType)) {
        openWindows.push(gameType);
    }
    
    // Stagger position based on number of open windows
    const offset = openWindows.indexOf(gameType) * 30;
    gameWindow.style.top = `calc(50% + ${offset}px)`;
    gameWindow.style.left = `calc(50% + ${offset}px)`;
    
    gameWindow.classList.remove('hidden', 'minimized');
    overlay.classList.remove('hidden');
    
    // Event handlers
    overlay.onclick = () => closeGame(gameType);
    gameWindow.onclick = (e) => {
        if (gameWindow.classList.contains('minimized')) {
            restoreGame(gameType);
            e.stopPropagation();
        } else {
            // Bring to front when clicked
            windowZIndex += 10;
            gameWindow.style.zIndex = windowZIndex;
        }
    };
}

function closeGame(gameType) {
    const gameWindow = document.getElementById(gameType + 'GameWindow');
    const overlay = document.getElementById('gameOverlay');
    
    if (confirm('Are you sure you want to close this game?')) {
        gameWindow.classList.add('hidden');
        
        // Remove from open windows
        openWindows = openWindows.filter(window => window !== gameType);
        
        // Hide overlay if no windows open
        if (openWindows.length === 0) {
            overlay.classList.add('hidden');
        }
        
        // Reset game state and clear stake input
        if (gameType === 'chess') {
            selectedSquare = null;
            currentPlayer = 'white';
        } else if (gameType === 'checkers') {
            currentPlayer = 'red';
        } else if (gameType === 'word') {
            currentWordRound = 1;
            playerScore = 0;
            opponentScore = 0;
        }
        
        document.getElementById(gameType + 'Stake').value = '';
        showTransactionStatus('Game closed');
    }
}

// Updated start game functions to add to active games lobby
async function startChessGame() {
    if (!userAddress) {
        alert('Please connect your wallet first!');
        return;
    }
    
    const stakeAmount = parseFloat(document.getElementById('chessStake').value);
    if (!stakeAmount || stakeAmount < 0.01) {
        alert('Please enter a valid stake amount (minimum 0.01 CORE)');
        return;
    }
    
    try {
        showTransactionStatus('Creating chess game...');
        
        const stakeWei = ethers.utils.parseEther(stakeAmount.toString());
        const tx = await gameContract.createGame(0, stakeWei, { value: stakeWei });
        
        showTransactionStatus('‚è≥ Transaction submitted...', tx.hash);
        const receipt = await tx.wait();
        
        // Add to active games lobby
        const newGame = {
            id: Date.now(),
            type: 'chess',
            creator: userAddress.substring(0, 8) + '...',
            stake: stakeAmount,
            status: 'waiting'
        };
        activeGames.push(newGame);
        updateActiveGames();
        
        // Open game window
        openGameWindow('chess');
        document.getElementById('chessStatus').textContent = 'Waiting for opponent...';
        initializeChessBoard();
        
        playerStats.gamesPlayed++;
        updateProfileDisplay();
        
        showTransactionStatus('‚úÖ Chess game created! Waiting for opponent...');
        addChatMessage('System', `üéÆ New chess game created! Stake: ${stakeAmount} CORE`);
        
    } catch (error) {
        console.error('Error creating chess game:', error);
        showTransactionStatus('‚ùå Error creating game: ' + error.message);
    }
}


// Initialize active games on page load
document.addEventListener('DOMContentLoaded', () => {
    updateActiveGames();
    
    // Update active games every 30 seconds
    setInterval(updateActiveGames, 30000);
    
    // Simulate new games being created by other players
    setInterval(() => {
        if (Math.random() < 0.3 && activeGames.length < 8) {
            const gameTypes = ['chess', 'checkers', 'words'];
            const players = ['CryptoKing', 'GameMaster', 'BlockchainBro', 'TokenMaster', 'WordWizard'];
            const stakes = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0, 1.5, 2.0];
            
            const newGame = {
                id: Date.now() + Math.random(),
                type: gameTypes[Math.floor(Math.random() * gameTypes.length)],
                creator: players[Math.floor(Math.random() * players.length)],
                stake: stakes[Math.floor(Math.random() * stakes.length)],
                status: 'waiting'
            };
            
            activeGames.push(newGame);
            updateActiveGames();
            
            const gameIcon = newGame.type === 'chess' ? '‚ôüÔ∏è' : newGame.type === 'checkers' ? '‚ö´' : 'üìù';
            addChatMessage('System', `üéÆ ${newGame.creator} created new ${gameIcon} game! Stake: ${newGame.stake} CORE`);
        }
    }, 45000);
});
        
    </script>
</body>
</html>
