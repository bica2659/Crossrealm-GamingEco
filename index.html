<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossRealm Gaming Ecosystem - Live Blockchain Gaming Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <div class="background"></div>
    
    <!-- Header -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-dice-d20 logo-icon"></i>
            <h1>CROSSREALM</h1>
        </div>
        <div class="nav-menu" id="navMenu">
            <div class="nav-item active" onclick="showSection('lobby')">üéØ Game Lobby</div>
            <div class="nav-item" onclick="showSection('active')">üéÆ My Games</div>
            <div class="nav-item" onclick="showSection('create')">‚ûï Create Game</div>
            <div class="nav-item" onclick="showSection('games')">‚ôüÔ∏è Games</div>
            <div class="nav-item" onclick="showSection('tournaments')">üèÜ Tournaments</div>
            <div class="nav-item" onclick="showSection('profile')">üë§ Profile</div>
            <div class="nav-item" onclick="showSection('chat')">üí¨ Chat</div>
            <div class="nav-item" onclick="showSection('settings')">‚öôÔ∏è Settings</div>
        </div>
        <div class="live-badge">üî¥ LIVE ON CORE</div>
        <div class="wallet-section">
            <div class="wallet-info">
                <div class="connection-status" id="connectionStatus">
                    <span class="connection-indicator disconnected"></span>Not Connected
                </div>
                <div class="balance" id="balanceDisplay">0.00 CORE</div>
            </div>
            <button class="connect-btn" id="connectBtn">
                <i class="fas fa-plug"></i> Connect Wallet
            </button>
            <button class="disconnect-btn hidden" id="disconnectBtn">Disconnect</button>
        </div>
    </div>
    <!-- Age Verification Modal -->
    <div class="age-verification" id="ageVerificationModal">
        <div class="verification-content">
            <h1><i class="fas fa-exclamation-triangle"></i> Age Verification Required</h1>
            <p>This platform contains blockchain-based games that involve financial stakes. You must be 18 years or older to access this content.</p>
            <div class="warning">
                <p><i class="fas fa-exclamation-circle"></i> Gambling involves risk. Please play responsibly. Only gamble with funds you can afford to lose.</p>
            </div>
            <p>By entering this site, you confirm that you are at least 18 years of age and agree to our Terms of Service.</p>
            <div class="verification-buttons">
                <button class="verify-btn accept" onclick="verifyAge(true)">I am 18+</button>
                <button class="verify-btn decline" onclick="verifyAge(false)">Under 18</button>
            </div>
        </div>
    </div>

    <!-- Enhanced Anti-Bot Protection Modal -->
    <div class="anti-bot-challenge hidden" id="antiBotChallenge">
        <div>
            <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üõ°Ô∏è Human Verification</h3>
            <p style="margin-bottom: 1rem;">Please complete this challenge to continue playing:</p>
            <p id="captchaInstructions" style="margin-bottom: 1rem; font-weight: bold; color: #f39c12;">
                Select all squares containing chess pieces
            </p>
            
            <div class="captcha-grid" id="captchaGrid">
                <!-- Grid will be populated by JavaScript -->
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">
                <button class="verify-btn accept" onclick="verifyCaptcha()" id="verifyCaptchaBtn" disabled>
                    Verify
                </button>
                <button class="verify-btn" onclick="refreshCaptcha()" style="background: #666;">
                    <i class="fas fa-refresh"></i> New Challenge
                </button>
            </div>
            
            <p style="margin-top: 1rem; font-size: 0.8rem; color: #aaa;">
                This helps us prevent automated bots and ensures fair play for all users.
            </p>
        </div>
    </div>

    <!-- Enhanced Transaction Status -->
    <div class="transaction-status" id="transactionStatus">
        <div class="tx-header">
            <span id="txStatusIcon">üîÑ</span>
            <span id="txStatusTitle">Processing...</span>
            <button class="tx-close" onclick="hideTransactionStatus()">√ó</button>
        </div>
        <div id="txStatusMessage">Processing transaction...</div>
        <div class="tx-hash" id="txHash"></div>
        <div class="tx-progress" id="txProgress">
            <div class="progress-bar">
                <div class="progress-fill" id="txProgressFill" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- Game Settlement Modal -->
    <div class="settlement-modal hidden" id="settlementModal">
        <div class="settlement-content">
            <div class="settlement-header">
                <h2 id="settlementTitle">üéâ Game Complete!</h2>
                <button class="settlement-close" onclick="closeSettlement()">√ó</button>
            </div>
            <div class="settlement-body">
                <div class="settlement-result" id="settlementResult">
                    <!-- Settlement details will be populated here -->
                </div>
                <div class="settlement-breakdown" id="settlementBreakdown">
                    <!-- Fee breakdown will be shown here -->
                </div>
                <div class="settlement-actions">
                    <button class="settlement-btn primary" onclick="claimWinnings()" id="claimBtn">
                        <i class="fas fa-coins"></i> Claim Winnings
                    </button>
                    <button class="settlement-btn secondary" onclick="viewGameAnalysis()">
                        <i class="fas fa-chart-line"></i> View Analysis
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Overlay -->
    <div class="game-overlay hidden" id="gameOverlay"></div>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #4e54c8;
            --primary-dark: #363a9e;
            --secondary: #f39c12;
            --dark: #1a1c2c;
            --light: #f5f7fa;
            --danger: #e74c3c;
            --success: #2ecc71;
            --warning: #f1c40f;
            --gray: #95a5a6;
            --accent: #4ecdc4;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-success: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            --gradient-danger: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        html, body {
            height: 100%;
            overflow-x: hidden;
        }

        body {
            background: linear-gradient(135deg, #1a1c2c, #2c3e50);
            color: var(--light);
            position: relative;
        }

        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1620336655052-b57986f5a26a?q=80&w=1920') no-repeat center center;
            background-size: cover;
            opacity: 0.1;
            z-index: -1;
        }

        .hidden {
            display: none !important;
        }

        /* Enhanced Animation System */
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px var(--accent); }
            50% { box-shadow: 0 0 20px var(--accent), 0 0 30px var(--accent); }
        }

        /* Enhanced Connection Status Indicators */
        .connection-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .connected {
            background: #00ff88;
            animation: pulse 2s infinite;
        }

        .disconnected {
            background: #ff6b6b;
        }

        .pending {
            background: #f1c40f;
            animation: blink 1s infinite;
        }

        .error {
            background: #e74c3c;
            animation: shake 0.5s infinite;
        }
        /* Enhanced Header Styles */
        .header {
            position: relative;
            z-index: 100;
            background: linear-gradient(135deg, #1a1c2c, #2c3e50);
            padding: 1rem;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            min-height: 80px;
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo h1 {
            font-size: 1.8rem;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            animation: spin 10s linear infinite;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-menu::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            padding: 0.5rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            white-space: nowrap;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .nav-item:hover::before {
            left: 100%;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(78, 205, 196, 0.5);
            transform: translateY(-2px);
        }

        .nav-item.active {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            color: white;
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }

        .nav-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .live-badge {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }

        .wallet-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .wallet-info {
            text-align: right;
        }

        .connection-status {
            font-size: 0.9rem;
            color: #ff6b6b;
            font-weight: 500;
        }

        .balance {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .connect-btn, .disconnect-btn {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .disconnect-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            margin-left: 0.5rem;
        }

        .connect-btn:hover, .disconnect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }

        .connect-btn::before, .disconnect-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .connect-btn:hover::before, .disconnect-btn:hover::before {
            left: 100%;
        }
        /* Enhanced Age Verification Modal */
        .age-verification {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.5s ease;
        }

        .verification-content {
            background: var(--dark);
            border-radius: 16px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
            box-shadow: var(--shadow);
            border: 2px solid var(--primary);
            position: relative;
            z-index: 10000;
            animation: slideIn 0.5s ease;
        }

        .verification-content h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--secondary);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .verification-content p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.6;
            color: var(--light);
        }

        .verification-content .warning {
            background: rgba(231, 76, 60, 0.2);
            border-left: 4px solid var(--danger);
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            text-align: left;
            backdrop-filter: blur(5px);
        }

        .verification-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .verify-btn {
            padding: 1rem 2rem;
            border-radius: 25px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            min-width: 120px;
            position: relative;
            overflow: hidden;
        }

        .verify-btn.accept {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            color: white;
        }

        .verify-btn.decline {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .verify-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Enhanced Anti-Bot Protection */
        .anti-bot-challenge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 2rem;
            z-index: 10000;
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: fadeIn 0.3s ease;
        }

        .captcha-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .captcha-tile {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .captcha-tile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .captcha-tile:hover::before {
            transform: translateX(100%);
        }

        .captcha-tile:hover {
            background: rgba(78, 205, 196, 0.2);
            border-color: var(--accent);
            transform: scale(1.05);
        }

        .captcha-tile.selected {
            background: rgba(78, 205, 196, 0.4);
            border-color: var(--accent);
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.5);
        }

        /* Enhanced Transaction Status */
        .transaction-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid var(--accent);
            border-radius: 10px;
            padding: 1rem;
            max-width: 350px;
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            word-wrap: break-word;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
        }

        .transaction-status.show {
            transform: translateX(0);
            animation: slideIn 0.3s ease;
        }

        .tx-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .tx-close {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tx-close:hover {
            color: white;
        }

        .tx-hash {
            font-family: monospace;
            font-size: 0.8rem;
            word-break: break-all;
            color: var(--accent);
            margin-top: 0.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .tx-hash:hover {
            color: #44a08d;
        }

        .tx-progress {
            margin-top: 0.5rem;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #00ff88);
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        /* Enhanced Settlement Modal */
        .settlement-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.5s ease;
        }

        .settlement-content {
            background: var(--dark);
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
            box-shadow: var(--shadow);
            border: 2px solid var(--accent);
            animation: bounce 0.6s ease;
        }

        .settlement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .settlement-header h2 {
            color: var(--accent);
            font-size: 1.5rem;
            margin: 0;
        }

        .settlement-close {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            font-size: 1.5rem;
            padding: 0;
            transition: color 0.3s ease;
        }

        .settlement-close:hover {
            color: white;
        }

        .settlement-result {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .settlement-breakdown {
            margin-bottom: 1.5rem;
            text-align: left;
            font-size: 0.9rem;
            color: #aaa;
        }

        .settlement-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .settlement-btn {
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            min-width: 150px;
        }

        .settlement-btn.primary {
            background: var(--gradient-success);
            color: white;
        }

        .settlement-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--accent);
            border: 1px solid var(--accent);
        }

        .settlement-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
            overflow: hidden;
        }

        .sidebar {
            width: 350px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            overflow-y: auto;
            max-height: calc(100vh - 80px);
            scrollbar-width: thin;
            scrollbar-color: var(--accent) transparent;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 3px;
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            max-height: calc(100vh - 80px);
        }

        /* Enhanced Sidebar Components */
        .live-lobby {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 2px solid var(--accent);
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .live-lobby::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(78, 205, 196, 0.1), transparent);
            transition: left 2s;
        }

        .live-lobby:hover::before {
            left: 100%;
        }

        .live-lobby h3 {
            color: var(--accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
        }

        .lobby-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .stat-icon {
            font-size: 1.2rem;
            color: var(--accent);
        }

        .stat-details {
            flex: 1;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            font-size: 0.7rem;
            color: #aaa;
        }

        /* Smart Contract Status */
        .contract-status {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .contract-address {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.5rem;
            border-radius: 5px;
            margin: 0.5rem 0;
            word-break: break-all;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid var(--accent);
            border-radius: 5px;
            padding: 0.3rem 0.6rem;
            color: var(--accent);
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .copy-btn:hover {
            background: rgba(78, 205, 196, 0.3);
            transform: scale(1.1);
        }

        .contract-verification {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .verification-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }

        .verification-item .fas {
            width: 16px;
        }

        .verified {
            color: #00ff88;
        }

        .security {
            color: #4ecdc4;
        }

        .stats {
            color: #f39c12;
        }

        /* Activity Feed */
        .activity-feed {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }

        .activity-item {
            padding: 0.5rem;
            margin: 0.25rem 0;
            background: rgba(78, 205, 196, 0.1);
            border-radius: 5px;
            font-size: 0.8rem;
            border-left: 3px solid var(--accent);
            animation: fadeIn 0.5s ease;
        }

        .activity-refresh {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            padding: 0.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .activity-refresh:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Leaderboard */
        .leaderboard {
            margin-bottom: 1rem;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            transform: translateX(5px);
        }

        .leaderboard-item.gold {
            background: rgba(255, 215, 0, 0.1);
            border-left: 3px solid #ffd700;
        }

        .leaderboard-item.silver {
            background: rgba(192, 192, 192, 0.1);
            border-left: 3px solid #c0c0c0;
        }

        .leaderboard-item.bronze {
            background: rgba(205, 127, 50, 0.1);
            border-left: 3px solid #cd7f32;
        }

        .rank {
            font-size: 1.2rem;
            width: 30px;
            text-align: center;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .player-games {
            font-size: 0.7rem;
            color: #aaa;
        }

        .player-score {
            font-weight: bold;
            color: var(--accent);
        }

        .leaderboard-view-all {
            width: 100%;
            background: var(--gradient-primary);
            border: none;
            border-radius: 5px;
            padding: 0.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .leaderboard-view-all:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        /* Server Status */
        .server-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .server-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .server-item.online {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .server-item.warning {
            background: rgba(241, 196, 15, 0.1);
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .server-item.error {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .server-icon {
            font-size: 1rem;
            color: #00ff88;
        }

        .server-info {
            flex: 1;
            text-align: center;
        }

        .server-status {
            font-weight: bold;
            font-size: 0.8rem;
            color: #00ff88;
        }

        .server-label {
            font-size: 0.7rem;
            color: #aaa;
        }

        .network-info {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 0.5rem;
        }

        .network-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin: 0.2rem 0;
        }

        .network-label {
            color: #aaa;
        }

        .network-value {
            color: var(--accent);
            font-weight: bold;
        }

        /* Games List */
        .games-list {
            margin-bottom: 1rem;
        }

        .game-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .game-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .game-type {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .game-stake {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--warning);
        }

        .game-info {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 0.5rem;
        }

        .game-actions {
            display: flex;
            gap: 0.5rem;
        }

        .game-btn {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .game-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }

        .game-btn.primary {
            background: var(--gradient-primary);
        }

        .game-btn.danger {
            background: var(--gradient-danger);
        }

        /* Create Game Section */
        .create-game-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .create-game-section h2 {
            color: var(--accent);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .game-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .game-type-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .game-type-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(78, 205, 196, 0.1), transparent);
            transition: left 0.5s;
        }

        .game-type-card:hover::before {
            left: 100%;
        }

        .game-type-card:hover,
        .game-type-card.selected {
            border-color: var(--accent);
            background: rgba(78, 205, 196, 0.1);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(78, 205, 196, 0.2);
        }

        .game-type-card .game-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .game-type-card h3 {
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .game-type-card p {
            margin-bottom: 1rem;
            color: #aaa;
            line-height: 1.4;
        }

        .game-features {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .feature-tag {
            background: rgba(78, 205, 196, 0.2);
            color: var(--accent);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            border: 1px solid rgba(78, 205, 196, 0.3);
        }

        .popularity-indicator {
            margin-top: 1rem;
        }

        .popularity-bar {
            height: 4px;
            background: var(--accent);
            border-radius: 2px;
            margin-bottom: 0.3rem;
            transition: width 0.3s ease;
        }

        .popularity-text {
            font-size: 0.7rem;
            color: #aaa;
        }

        .stake-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 0.8rem;
            color: white;
            font-size: 1rem;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }

        .stake-input:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.2);
        }

        .create-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--accent), #44a08d);
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .create-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.3);
        }

        .create-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #aaa;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
            color: var(--accent);
        }

        .empty-state h3 {
            margin-bottom: 1rem;
            color: var(--light);
        }

        .empty-state p {
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .empty-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .empty-action-btn {
            background: var(--gradient-primary);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .empty-action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .empty-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s ease-in-out infinite;
        }

        /* Skill Badges */
        .skill-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        .skill-bronze {
            background: rgba(205, 127, 50, 0.2);
            color: #cd7f32;
            border: 1px solid rgba(205, 127, 50, 0.3);
        }

        .skill-silver {
            background: rgba(192, 192, 192, 0.2);
            color: #c0c0c0;
            border: 1px solid rgba(192, 192, 192, 0.3);
        }

        .skill-gold {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .skill-diamond {
            background: rgba(185, 242, 255, 0.2);
            color: #b9f2ff;
            border: 1px solid rgba(185, 242, 255, 0.3);
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.5rem;
            }

            .nav-menu {
                order: 3;
                width: 100%;
                justify-content: flex-start;
                gap: 0.5rem;
                padding: 0.5rem 0;
            }

            .nav-item {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }

            .wallet-section {
                order: 2;
                width: 100%;
                justify-content: space-between;
            }

            .verification-content {
                padding: 20px;
                margin: 1rem;
            }

            .settlement-content {
                padding: 1rem;
                margin: 1rem;
            }

            .settlement-actions {
                flex-direction: column;
            }

            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                order: 2;
                padding: 1rem;
                max-height: none;
            }

            .content-area {
                order: 1;
                padding: 1rem;
                max-height: none;
            }

            .lobby-stats {
                grid-template-columns: 1fr;
            }

            .game-type-selector {
                grid-template-columns: 1fr;
            }

            .server-grid {
                grid-template-columns: 1fr;
            }

            .leaderboard-item {
                flex-wrap: wrap;
                gap: 0.3rem;
            }

            .player-info {
                min-width: 120px;
            }
        }

        /* Accessibility Enhancements */
        .keyboard-navigation .nav-item:focus,
        .keyboard-navigation .connect-btn:focus,
        .keyboard-navigation .verify-btn:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
    <!-- Enhanced Game Windows -->
    <!-- Chess Game Window -->
    <div class="game-window hidden" id="chessGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">‚ôüÔ∏è Chess Masters 
                <span class="skill-badge skill-gold" id="chessSkillBadge">Gold</span>
                <span class="validation-status validated" title="Server Validated">‚úì</span>
                <span class="sync-status" id="chessSyncStatus" title="Synchronized">üîÑ</span>
            </div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('chess')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('chess')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-info-bar">
                <div class="player-info">
                    <div class="player-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="player-details">
                        <strong>You:</strong> <span id="chessPlayerName">White</span>
                        <div class="timer" id="chessPlayerTimer">10:00</div>
                        <div class="move-indicator" id="chessPlayerMove">‚óè</div>
                    </div>
                </div>
                <div class="game-status-center">
                    <div class="game-status" id="chessStatus">Waiting for opponent...</div>
                    <div class="move-history" id="chessMoveHistory">
                        <div class="move-list" id="chessMoveList"></div>
                    </div>
                </div>
                <div class="opponent-info">
                    <div class="player-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="player-details">
                        <strong>Opponent:</strong> <span id="chessOpponentName">-</span>
                        <div class="timer" id="chessOpponentTimer">10:00</div>
                        <div class="move-indicator" id="chessOpponentMove">‚óã</div>
                    </div>
                </div>
            </div>
            <div class="chess-board-container">
                <div class="chess-coordinates-top">
                    <span>a</span><span>b</span><span>c</span><span>d</span><span>e</span><span>f</span><span>g</span><span>h</span>
                </div>
                <div class="chess-board-wrapper">
                    <div class="chess-coordinates-left">
                        <span>8</span><span>7</span><span>6</span><span>5</span><span>4</span><span>3</span><span>2</span><span>1</span>
                    </div>
                    <div class="chess-board" id="chessBoard"></div>
                    <div class="chess-coordinates-right">
                        <span>8</span><span>7</span><span>6</span><span>5</span><span>4</span><span>3</span><span>2</span><span>1</span>
                    </div>
                </div>
                <div class="chess-coordinates-bottom">
                    <span>a</span><span>b</span><span>c</span><span>d</span><span>e</span><span>f</span><span>g</span><span>h</span>
                </div>
            </div>
            <div class="game-controls">
                <button class="game-btn danger" onclick="resignChess()">
                    <i class="fas fa-flag"></i> Resign
                </button>
                <button class="game-btn neutral" onclick="drawChess()">
                    <i class="fas fa-handshake"></i> Offer Draw
                </button>
                <button class="game-btn neutral" onclick="requestUndo()">
                    <i class="fas fa-undo"></i> Request Undo
                </button>
                <button class="game-btn primary" onclick="analyzePosition()">
                    <i class="fas fa-brain"></i> Analyze
                </button>
            </div>
            <div class="game-chat">
                <h4 style="margin-bottom: 0.5rem; color: #4ecdc4;">
                    <i class="fas fa-comments"></i> Game Chat
                </h4>
                <div class="game-chat-messages" id="chessGameChat">
                    <div class="game-chat-message system"><strong>System:</strong> Game started!</div>
                </div>
                <div class="game-chat-input">
                    <input type="text" placeholder="Type a message..." id="chessChatInput" 
                           onkeypress="handleGameChatKeyPress(event, 'chess')" maxlength="200">
                    <button onclick="sendGameChatMessage('chess')">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkers Game Window -->
    <div class="game-window hidden" id="checkersGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">‚ö´ Checkers Pro 
                <span class="skill-badge skill-silver" id="checkersSkillBadge">Silver</span>
                <span class="validation-status validated" title="Server Validated">‚úì</span>
                <span class="sync-status" id="checkersSyncStatus" title="Synchronized">üîÑ</span>
            </div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('checkers')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('checkers')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-info-bar">
                <div class="player-info">
                    <div class="player-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="player-details">
                        <strong>You:</strong> <span id="checkersPlayerName">Red</span>
                        <div class="timer" id="checkersPlayerTimer">5:00</div>
                        <div class="captured-pieces" id="checkersPlayerCaptured">
                            <span class="capture-count">0</span> captured
                        </div>
                    </div>
                </div>
                <div class="game-status-center">
                    <div class="game-status" id="checkersStatus">Waiting for opponent...</div>
                    <div class="game-score">
                        <div class="score-item">
                            <span class="score-label">Red Pieces:</span>
                            <span class="score-value" id="redPiecesCount">12</span>
                        </div>
                        <div class="score-item">
                            <span class="score-label">Black Pieces:</span>
                            <span class="score-value" id="blackPiecesCount">12</span>
                        </div>
                    </div>
                </div>
                <div class="opponent-info">
                    <div class="player-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="player-details">
                        <strong>Opponent:</strong> <span id="checkersOpponentName">-</span>
                        <div class="timer" id="checkersOpponentTimer">5:00</div>
                        <div class="captured-pieces" id="checkersOpponentCaptured">
                            <span class="capture-count">0</span> captured
                        </div>
                    </div>
                </div>
            </div>
            <div class="checkers-board" id="checkersBoard"></div>
            <div class="game-controls">
                <button class="game-btn danger" onclick="resignCheckers()">
                    <i class="fas fa-flag"></i> Resign
                </button>
                <button class="game-btn neutral" onclick="requestUndo()">
                    <i class="fas fa-undo"></i> Request Undo
                </button>
                <button class="game-btn primary" onclick="showPossibleMoves()">
                    <i class="fas fa-eye"></i> Show Moves
                </button>
            </div>
            <div class="game-chat">
                <h4 style="margin-bottom: 0.5rem; color: #4ecdc4;">
                    <i class="fas fa-comments"></i> Game Chat
                </h4>
                <div class="game-chat-messages" id="checkersGameChat">
                    <div class="game-chat-message system"><strong>System:</strong> Game started!</div>
                </div>
                <div class="game-chat-input">
                    <input type="text" placeholder="Type a message..." id="checkersChatInput" 
                           onkeypress="handleGameChatKeyPress(event, 'checkers')" maxlength="200">
                    <button onclick="sendGameChatMessage('checkers')">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Word Game Window -->
    <div class="game-window hidden" id="wordGameWindow">
        <div class="game-window-header">
            <div class="game-window-title">üìù Word Battle 
                <span class="skill-badge skill-bronze" id="wordSkillBadge">Bronze</span>
                <span class="validation-status validated" title="Server Validated">‚úì</span>
                <span class="sync-status" id="wordSyncStatus" title="Synchronized">üîÑ</span>
            </div>
            <div class="game-window-controls">
                <button class="window-btn minimize-btn" onclick="minimizeGame('word')">‚àí</button>
                <button class="window-btn close-btn" onclick="closeGame('word')">√ó</button>
            </div>
        </div>
        <div class="game-window-content">
            <div class="game-info-bar">
                <div class="player-info">
                    <div class="player-details">
                        <strong>You:</strong> <span id="wordPlayerName">Player</span>
                        <div class="timer" id="wordPlayerTimer">2:00</div>
                        <div class="word-score">Score: <span id="playerWordScore">0</span></div>
                    </div>
                </div>
                <div class="game-status-center">
                    <div class="game-status" id="wordStatus">Round 1 of 3</div>
                    <div class="round-indicator">
                        <div class="round-dot active"></div>
                        <div class="round-dot"></div>
                        <div class="round-dot"></div>
                    </div>
                </div>
                <div class="opponent-info">
                    <div class="player-details">
                        <strong>Opponent:</strong> <span id="wordOpponentName">-</span>
                        <div class="timer" id="wordOpponentTimer">2:00</div>
                        <div class="word-score">Score: <span id="opponentWordScore">0</span></div>
                    </div>
                </div>
            </div>
            <div class="word-game">
                <div class="word-prompt">
                    <h4 id="wordPrompt">Make a word with these letters:</h4>
                    <div id="wordLetters" class="available-letters">BLOCKCHAIN</div>
                </div>
                <div class="word-input-section">
                    <input type="text" class="word-input" id="wordInput" 
                           placeholder="Enter your word..." maxlength="20" 
                           onkeypress="handleWordInputKeyPress(event)">
                    <div class="word-validation" id="wordValidation"></div>
                </div>
                <div class="word-scoring">
                    <div class="scoring-info">
                        <div class="score-breakdown">
                            <span>Base: +<span id="baseScore">0</span></span>
                            <span>Length: +<span id="lengthBonus">0</span></span>
                            <span>Bonus: +<span id="specialBonus">0</span></span>
                        </div>
                        <div class="total-score">Total: <span id="roundScore">0</span></div>
                    </div>
                </div>
                <div class="submitted-words">
                    <h5>Words This Round:</h5>
                    <div class="words-list" id="submittedWordsList"></div>
                </div>
                <div class="game-controls">
                    <button class="game-btn primary" onclick="submitWord()">
                        <i class="fas fa-check"></i> Submit Word
                    </button>
                    <button class="game-btn neutral" onclick="skipRound()">
                        <i class="fas fa-forward"></i> Skip Round
                    </button>
                    <button class="game-btn secondary" onclick="shuffleLetters()">
                        <i class="fas fa-random"></i> Shuffle
                    </button>
                </div>
            </div>
            <div class="game-chat">
                <h4 style="margin-bottom: 0.5rem; color: #4ecdc4;">
                    <i class="fas fa-comments"></i> Game Chat
                </h4>
                <div class="game-chat-messages" id="wordGameChat">
                    <div class="game-chat-message system"><strong>System:</strong> Game started!</div>
                </div>
                <div class="game-chat-input">
                    <input type="text" placeholder="Type a message..." id="wordChatInput" 
                           onkeypress="handleGameChatKeyPress(event, 'word')" maxlength="200">
                    <button onclick="sendGameChatMessage('word')">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Analysis Modal -->
    <div class="analysis-modal hidden" id="analysisModal">
        <div class="analysis-content">
            <div class="analysis-header">
                <h3><i class="fas fa-chart-line"></i> Game Analysis</h3>
                <button class="analysis-close" onclick="closeAnalysis()">√ó</button>
            </div>
            <div class="analysis-body">
                <div class="analysis-tabs">
                    <button class="tab-btn active" onclick="showAnalysisTab('moves')">Moves</button>
                    <button class="tab-btn" onclick="showAnalysisTab('stats')">Statistics</button>
                    <button class="tab-btn" onclick="showAnalysisTab('timeline')">Timeline</button>
                </div>
                <div class="analysis-content-area" id="analysisContentArea">
                    <!-- Analysis content will be populated here -->
                </div>
            </div>
        </div>
    </div>
    <!-- Enhanced Game Window Styles -->
    <style>
        /* Enhanced Game Window Styles */
        .game-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 1.5rem;
            z-index: 1000;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            min-width: 800px;
            animation: fadeIn 0.3s ease;
        }

        .game-window.minimized {
            top: auto;
            bottom: 20px;
            right: 20px;
            left: auto;
            transform: none;
            width: 300px;
            height: 60px;
            overflow: hidden;
            cursor: pointer;
            animation: slideIn 0.3s ease;
        }

        .game-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-window-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .validation-status {
            color: #00ff88;
            font-size: 0.8rem;
        }

        .sync-status {
            font-size: 0.8rem;
            animation: spin 2s linear infinite;
        }

        .sync-status.synced {
            animation: none;
            color: #00ff88;
        }

        .sync-status.error {
            animation: shake 0.5s infinite;
            color: #ff6b6b;
        }

        .game-window-controls {
            display: flex;
            gap: 0.5rem;
        }

        .window-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .window-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .minimize-btn {
            background: rgba(255, 193, 7, 0.3);
        }

        .close-btn {
            background: rgba(220, 53, 69, 0.3);
        }

        .game-window-content {
            display: block;
        }

        .game-window.minimized .game-window-content {
            display: none;
        }

        /* Enhanced Game Info Bar */
        .game-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            backdrop-filter: blur(5px);
        }

        .player-info, .opponent-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
        }

        .player-avatar {
            font-size: 2rem;
            color: var(--accent);
        }

        .player-details {
            text-align: center;
        }

        .timer {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 0.3rem 0.6rem;
            margin-top: 0.5rem;
            font-family: monospace;
            font-size: 1.1rem;
            color: #00ff88;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .timer.warning {
            color: #f1c40f;
            border-color: rgba(241, 196, 15, 0.3);
            animation: blink 1s infinite;
        }

        .timer.danger {
            color: #e74c3c;
            border-color: rgba(231, 76, 60, 0.3);
            animation: blink 0.5s infinite;
        }

        .move-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin: 0.5rem auto;
            background: var(--accent);
            animation: pulse 1s infinite;
        }

        .move-indicator.inactive {
            background: #666;
            animation: none;
        }

        .game-status-center {
            text-align: center;
            flex: 1;
            margin: 0 1rem;
        }

        .game-status {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--accent);
            font-weight: bold;
        }

        .move-history {
            max-height: 100px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 0.5rem;
        }

        .move-list {
            font-family: monospace;
            font-size: 0.8rem;
            color: #aaa;
        }

        /* Enhanced Chess Board Styles */
        .chess-board-container {
            margin: 1rem 0;
            text-align: center;
        }

        .chess-coordinates-top,
        .chess-coordinates-bottom {
            display: flex;
            justify-content: center;
            gap: 0;
            margin: 0.5rem 0;
        }

        .chess-coordinates-top span,
        .chess-coordinates-bottom span {
            width: 60px;
            text-align: center;
            font-weight: bold;
            color: var(--accent);
        }

        .chess-board-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }

        .chess-coordinates-left,
        .chess-coordinates-right {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0;
        }

        .chess-coordinates-left span,
        .chess-coordinates-right span {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--accent);
        }

        .chess-board, .checkers-board {
            display: grid;
            grid-template-columns: repeat(8, 60px);
            grid-template-rows: repeat(8, 60px);
            border: 3px solid var(--accent);
            border-radius: 10px;
            background: #f4f4f4;
            position: relative;
            box-shadow: var(--shadow);
        }

        .chess-square, .checkers-square {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            user-select: none;
        }

        .chess-square.white, .checkers-square.light {
            background: #f0d9b5;
        }

        .chess-square.black, .checkers-square.dark {
            background: #b58863;
        }

        .chess-square.selected {
            background: #ff6b6b !important;
            box-shadow: inset 0 0 10px rgba(255, 107, 107, 0.5);
            animation: glow 1s infinite;
        }

        .chess-square.possible-move {
            background: rgba(78, 205, 196, 0.3) !important;
        }

        .chess-square.possible-move::after {
            content: '‚óè';
            color: var(--accent);
            position: absolute;
            font-size: 1rem;
            animation: pulse 1s infinite;
        }

        .chess-square.last-move {
            background: rgba(255, 215, 0, 0.3) !important;
        }

        .chess-square.check {
            background: rgba(255, 0, 0, 0.4) !important;
            animation: blink 0.5s infinite;
        }

        /* Enhanced Checker Pieces */
        .checker-piece {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .checker-piece::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 80%;
            height: 80%;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), transparent);
        }

        .checker-piece:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }

        .red-piece {
            background: radial-gradient(circle, #ff4444, #cc0000);
            border-color: #990000;
        }

        .black-piece {
            background: radial-gradient(circle, #444444, #000000);
            border-color: #222;
        }

        .checker-piece.king::after {
            content: '‚ôî';
            position: absolute;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .checker-piece.selected {
            animation: glow 1s infinite;
        }
        /* Enhanced Word Game Styles */
        .word-game {
            text-align: center;
            padding: 1rem;
        }

        .word-prompt h4 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .available-letters {
            font-size: 2rem;
            color: #4ecdc4;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(78, 205, 196, 0.1);
            border-radius: 10px;
            border: 2px solid var(--accent);
            letter-spacing: 0.2rem;
            font-weight: bold;
        }

        .word-input-section {
            margin: 1rem 0;
        }

        .word-input {
            width: 100%;
            max-width: 300px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 0.8rem;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }

        .word-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
            outline: none;
        }

        .word-validation {
            font-size: 0.9rem;
            margin-top: 0.5rem;
            min-height: 1.2rem;
        }

        .word-validation.valid {
            color: #00ff88;
        }

        .word-validation.invalid {
            color: #ff6b6b;
        }

        .word-scoring {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .scoring-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .score-breakdown {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
            color: #aaa;
        }

        .total-score {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .submitted-words {
            margin: 1rem 0;
            text-align: left;
        }

        .submitted-words h5 {
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .words-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .word-chip {
            background: rgba(78, 205, 196, 0.2);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.8rem;
            border: 1px solid var(--accent);
        }

        .round-indicator {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .round-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .round-dot.active {
            background: var(--accent);
            animation: pulse 1s infinite;
        }

        .round-dot.completed {
            background: #00ff88;
        }

        /* Enhanced Game Controls */
        .game-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .game-btn {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .game-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .game-btn:hover::before {
            left: 100%;
        }

        .game-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }

        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-btn.primary {
            background: var(--gradient-primary);
        }

        .game-btn.danger {
            background: var(--gradient-danger);
        }

        .game-btn.neutral {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .game-btn.secondary {
            background: rgba(108, 117, 125, 0.8);
        }

        /* Enhanced In-Game Chat */
        .game-chat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
            max-height: 200px;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(5px);
        }

        .game-chat h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .game-chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 0.5rem;
            max-height: 120px;
            background: rgba(0, 0, 0, 0.2);
            padding: 0.5rem;
            border-radius: 5px;
        }

        .game-chat-message {
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
            word-wrap: break-word;
            padding: 0.2rem 0;
        }

        .game-chat-message.system {
            color: #aaa;
            font-style: italic;
        }

        .game-chat-message strong {
            color: var(--accent);
        }

        .game-chat-input {
            display: flex;
            gap: 0.5rem;
        }

        .game-chat-input input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            padding: 0.5rem;
            color: white;
            transition: all 0.3s ease;
        }

        .game-chat-input input:focus {
            border-color: var(--accent);
            outline: none;
        }

        .game-chat-input button {
            background: linear-gradient(45deg, var(--accent), #44a08d);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-chat-input button:hover {
            transform: scale(1.05);
        }

        /* Analysis Modal Styles */
        .analysis-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease;
        }

        .analysis-content {
            background: var(--dark);
            border-radius: 15px;
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            border: 2px solid var(--accent);
        }

        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analysis-header h3 {
            color: var(--accent);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .analysis-close {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            font-size: 1.5rem;
            transition: color 0.3s ease;
        }

        .analysis-close:hover {
            color: white;
        }

        .analysis-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tab-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active,
        .tab-btn:hover {
            background: var(--accent);
            border-color: var(--accent);
        }

        .analysis-content-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 1rem;
            min-height: 300px;
        }

        /* Enhanced Mobile Responsiveness for Game Windows */
        @media (max-width: 768px) {
            .game-window {
                min-width: 95vw;
                max-width: 95vw;
                padding: 1rem;
                margin: 1rem;
            }

            .chess-board, .checkers-board {
                grid-template-columns: repeat(8, 35px);
                grid-template-rows: repeat(8, 35px);
            }

            .chess-square, .checkers-square {
                font-size: 1.2rem;
            }

            .checker-piece {
                width: 30px;
                height: 30px;
            }

            .game-info-bar {
                flex-direction: column;
                gap: 0.5rem;
            }

            .player-info, .opponent-info {
                flex: none;
                width: 100%;
                justify-content: center;
            }

            .game-controls {
                flex-direction: column;
                align-items: center;
            }

            .game-btn {
                width: 100%;
                max-width: 200px;
            }

            .chess-coordinates-top span,
            .chess-coordinates-bottom span {
                width: 35px;
            }

            .chess-coordinates-left span,
            .chess-coordinates-right span {
                height: 35px;
            }
        }
    </style>
    <!-- Main Container -->
    <div class="main-container">
        <!-- Enhanced Sidebar -->
        <div class="sidebar">
            <!-- Smart Contract Status -->
            <div class="contract-status">
                <h3><i class="fas fa-shield-alt"></i> Smart Contract Status</h3>
                <div class="contract-address" id="contractAddress">
                    0x7af2cB8f93D0a75E0ba39E974B4e968EAe49028A
                    <button class="copy-btn" onclick="copyContractAddress()">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <div id="contractStatus">
                    <span class="connection-indicator pending"></span>
                    Connecting to Core Blockchain...
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="connectionProgress" style="width: 0%"></div>
                </div>
                <div class="contract-verification">
                    <div class="verification-item">
                        <i class="fas fa-check-circle verified"></i>
                        <span>Contract Verified</span>
                    </div>
                    <div class="verification-item">
                        <i class="fas fa-lock security"></i>
                        <span>Security Audited</span>
                    </div>
                    <div class="verification-item">
                        <i class="fas fa-chart-line stats"></i>
                        <span>Live Statistics</span>
                    </div>
                </div>
            </div>

            <!-- Enhanced Live Statistics -->
            <div class="live-lobby">
                <h3><i class="fas fa-chart-bar"></i> Live Platform Stats</h3>
                <div class="lobby-stats">
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-details">
                            <div class="stat-value" id="totalPlayers">247</div>
                            <div class="stat-label">Online Players</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-gamepad"></i></div>
                        <div class="stat-details">
                            <div class="stat-value" id="totalGames">89</div>
                            <div class="stat-label">Active Games</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-coins"></i></div>
                        <div class="stat-details">
                            <div class="stat-value" id="totalVolume">156.7</div>
                            <div class="stat-label">CORE Volume (24h)</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                        <div class="stat-details">
                            <div class="stat-value" id="totalTournaments">3</div>
                            <div class="stat-label">Live Tournaments</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Recent Activity Feed -->
            <div class="live-lobby">
                <h3><i class="fas fa-rss"></i> Recent Activity</h3>
                <div id="activityFeed" class="activity-feed">
                    <div class="activity-item">üéÆ Player123 won 0.5 CORE in Chess!</div>
                    <div class="activity-item">‚öîÔ∏è New tournament starting in 5 minutes</div>
                    <div class="activity-item">üî• High stakes game: 2.0 CORE</div>
                    <div class="activity-item">üìù WordMaster scored 150 points!</div>
                    <div class="activity-item">üèÜ Daily leaderboard updated</div>
                </div>
                <button class="activity-refresh" onclick="refreshActivityFeed()">
                    <i class="fas fa-sync-alt"></i> Refresh Feed
                </button>
            </div>

            <!-- Enhanced Tournament Leaderboard -->
            <div class="live-lobby">
                <h3><i class="fas fa-crown"></i> Tournament Leaders</h3>
                <div id="tournamentLeaderboard" class="leaderboard">
                    <div class="leaderboard-item gold">
                        <div class="rank">ü•á</div>
                        <div class="player-info">
                            <div class="player-name">CryptoKing</div>
                            <div class="player-games">15 wins</div>
                        </div>
                        <div class="player-score">127 pts</div>
                    </div>
                    <div class="leaderboard-item silver">
                        <div class="rank">ü•à</div>
                        <div class="player-info">
                            <div class="player-name">GameMaster</div>
                            <div class="player-games">12 wins</div>
                        </div>
                        <div class="player-score">89 pts</div>
                    </div>
                    <div class="leaderboard-item bronze">
                        <div class="rank">ü•â</div>
                        <div class="player-info">
                            <div class="player-name">ChessGM</div>
                            <div class="player-games">8 wins</div>
                        </div>
                        <div class="player-score">76 pts</div>
                    </div>
                </div>
                <button class="leaderboard-view-all" onclick="showSection('tournaments')">
                    <i class="fas fa-list"></i> View Full Leaderboard
                </button>
            </div>

            <!-- Enhanced Server Status -->
            <div class="live-lobby">
                <h3><i class="fas fa-server"></i> Network Status</h3>
                <div class="server-grid">
                    <div class="server-item online">
                        <div class="server-icon"><i class="fas fa-gamepad"></i></div>
                        <div class="server-info">
                            <div class="server-status">Online</div>
                            <div class="server-label">Game Server</div>
                        </div>
                    </div>
                    <div class="server-item online">
                        <div class="server-icon"><i class="fas fa-network-wired"></i></div>
                        <div class="server-info">
                            <div class="server-status" id="serverLatency">12ms</div>
                            <div class="server-label">Latency</div>
                        </div>
                    </div>
                    <div class="server-item online">
                        <div class="server-icon"><i class="fas fa-shield-check"></i></div>
                        <div class="server-info">
                            <div class="server-status">Active</div>
                            <div class="server-label">Validation</div>
                        </div>
                    </div>
                    <div class="server-item online">
                        <div class="server-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="server-info">
                            <div class="server-status">99.9%</div>
                            <div class="server-label">Uptime</div>
                        </div>
                    </div>
                </div>
                <div class="network-info">
                    <div class="network-item">
                        <span class="network-label">Block Height:</span>
                        <span class="network-value" id="blockHeight">15,234,567</span>
                    </div>
                    <div class="network-item">
                        <span class="network-label">Gas Price:</span>
                        <span class="network-value" id="gasPrice">15.2 gwei</span>
                    </div>
                    <div class="network-item">
                        <span class="network-label">CORE Price:</span>
                        <span class="network-value" id="corePrice">$1.234</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Game Lobby Section -->
            <div id="lobbySection">
                <div class="live-lobby">
                    <div class="lobby-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <h2 style="color: var(--accent); margin: 0; display: flex; align-items: center; gap: 0.5rem;"><i class="fas fa-dice"></i> Live Game Lobby</h2>
                        <div class="lobby-controls" style="display: flex; gap: 0.5rem;">
                            <button onclick="refreshLobby()" class="control-btn" title="Refresh Lobby" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; padding: 0.5rem; color: white; cursor: pointer; transition: all 0.3s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button onclick="toggleAutoRefresh()" class="control-btn" id="autoRefreshBtn" title="Auto Refresh" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; padding: 0.5rem; color: white; cursor: pointer; transition: all 0.3s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="games-list" id="gamesList">
                        <!-- Sample games will be populated here -->
                        <div class="game-item">
                            <div class="game-header">
                                <div class="game-type">‚ôüÔ∏è Chess Masters</div>
                                <div class="game-stake">0.05 CORE</div>
                            </div>
                            <div class="game-info">
                                Created by: DemoPlayer1 ‚Ä¢ Skill: Gold ‚Ä¢ Time: 10+5
                            </div>
                            <div class="game-actions">
                                <button class="game-btn primary" onclick="joinDemoGame('chess', 0.05)">
                                    <i class="fas fa-play"></i> Join Game
                                </button>
                            </div>
                        </div>
                        
                        <div class="game-item">
                            <div class="game-header">
                                <div class="game-type">‚ö´ Checkers Pro</div>
                                <div class="game-stake">0.02 CORE</div>
                            </div>
                            <div class="game-info">
                                Created by: DemoPlayer2 ‚Ä¢ Skill: Silver ‚Ä¢ Time: 5+3
                            </div>
                            <div class="game-actions">
                                <button class="game-btn primary" onclick="joinDemoGame('checkers', 0.02)">
                                    <i class="fas fa-play"></i> Join Game
                                </button>
                            </div>
                        </div>
                        
                        <div class="game-item">
                            <div class="game-header">
                                <div class="game-type">üìù Word Battle</div>
                                <div class="game-stake">0.01 CORE</div>
                            </div>
                            <div class="game-info">
                                Created by: DemoPlayer3 ‚Ä¢ Skill: Bronze ‚Ä¢ Time: 2+0
                            </div>
                            <div class="game-actions">
                                <button class="game-btn primary" onclick="joinDemoGame('words', 0.01)">
                                    <i class="fas fa-play"></i> Join Game
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="noGames" class="hidden empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <h3>No Active Games</h3>
                        <p>Be the first to create a game and start earning CORE!</p>
                        <button onclick="showSection('create')" class="empty-action-btn">
                            <i class="fas fa-plus"></i> Create First Game
                        </button>
                    </div>
                </div>
            </div>
            <!-- Enhanced Active Games Section -->
            <div id="activeSection" class="hidden">
                <div class="live-lobby">
                    <div class="lobby-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <h2 style="color: var(--accent); margin: 0; display: flex; align-items: center; gap: 0.5rem;"><i class="fas fa-play-circle"></i> My Active Games</h2>
                        <div class="lobby-controls" style="display: flex; gap: 0.5rem;">
                            <button onclick="refreshActiveGames()" class="control-btn" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; padding: 0.5rem; color: white; cursor: pointer; transition: all 0.3s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="games-list" id="activeGamesList">
                        <!-- Active games will be populated here -->
                    </div>
                    
                    <div id="noActiveGames" class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-chess-board"></i>
                        </div>
                        <h3>No Active Games</h3>
                        <p>Join a game from the lobby or create your own to start playing!</p>
                        <div class="empty-actions">
                            <button onclick="showSection('lobby')" class="empty-action-btn primary" style="background: var(--gradient-primary);">
                                <i class="fas fa-search"></i> Browse Games
                            </button>
                            <button onclick="showSection('create')" class="empty-action-btn secondary" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3);">
                                <i class="fas fa-plus"></i> Create Game
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Create Game Section -->
            <div id="createSection" class="hidden">
                <div class="create-game-section">
                    <h2><i class="fas fa-plus-circle"></i> Create New Game</h2>
                    
                    <div class="game-type-selector">
                        <div class="game-type-card" data-type="chess" onclick="selectGameType('chess')">
                            <div class="game-icon">‚ôüÔ∏è</div>
                            <h3>Chess Masters</h3>
                            <p>Strategic blockchain chess with full move validation</p>
                            <div class="game-features">
                                <span class="feature-tag">5-30 min</span>
                                <span class="feature-tag">Server Validated</span>
                                <span class="feature-tag">Anti-Cheat</span>
                            </div>
                            <div class="popularity-indicator">
                                <div class="popularity-bar" style="width: 85%"></div>
                                <span class="popularity-text">Very Popular</span>
                            </div>
                        </div>
                        <div class="game-type-card" data-type="checkers" onclick="selectGameType('checkers')">
                            <div class="game-icon">‚ö´</div>
                            <h3>Checkers Pro</h3>
                            <p>Fast-paced checkers with instant settlements</p>
                            <div class="game-features">
                                <span class="feature-tag">3-15 min</span>
                                <span class="feature-tag">Quick Play</span>
                                <span class="feature-tag">Beginner Friendly</span>
                            </div>
                            <div class="popularity-indicator">
                                <div class="popularity-bar" style="width: 65%"></div>
                                <span class="popularity-text">Popular</span>
                            </div>
                        </div>
                        <div class="game-type-card" data-type="words" onclick="selectGameType('words')">
                            <div class="game-icon">üìù</div>
                            <h3>Word Battle</h3>
                            <p>Quick word-building competition</p>
                            <div class="game-features">
                                <span class="feature-tag">1-5 min</span>
                                <span class="feature-tag">Dictionary Verified</span>
                                <span class="feature-tag">Educational</span>
                            </div>
                            <div class="popularity-indicator">
                                <div class="popularity-bar" style="width: 45%"></div>
                                <span class="popularity-text">Growing</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin: 2rem 0;">
                        <label for="gameStake" style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: var(--light);">Stake Amount (CORE)</label>
                        <input type="number" class="stake-input" id="gameStake" 
                               placeholder="Enter stake amount (min 0.01 CORE)" 
                               min="0.01" step="0.01" 
                               oninput="updateCreateButton()">
                        <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                            <button class="stake-preset" onclick="setStake(0.01)" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 5px; padding: 0.3rem 0.6rem; color: white; cursor: pointer; transition: all 0.3s ease; font-size: 0.8rem;">0.01</button>
                            <button class="stake-preset" onclick="setStake(0.1)" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 5px; padding: 0.3rem 0.6rem; color: white; cursor: pointer; transition: all 0.3s ease; font-size: 0.8rem;">0.1</button>
                            <button class="stake-preset" onclick="setStake(0.5)" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 5px; padding: 0.3rem 0.6rem; color: white; cursor: pointer; transition: all 0.3s ease; font-size: 0.8rem;">0.5</button>
                            <button class="stake-preset" onclick="setStake(1.0)" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 5px; padding: 0.3rem 0.6rem; color: white; cursor: pointer; transition: all 0.3s ease; font-size: 0.8rem;">1.0</button>
                        </div>
                    </div>
                    
                    <button class="create-btn" id="createGameBtn" onclick="createGame()" disabled>
                        <i class="fas fa-plus"></i> Select Game Type & Enter Stake
                    </button>
                </div>
            </div>

            <!-- Games Section -->
            <div id="gamesSection" class="hidden">
                <div class="live-lobby">
                    <h2><i class="fas fa-gamepad"></i> Available Games</h2>
                    <p style="margin-bottom: 2rem; color: #aaa;">Choose from our collection of blockchain-powered games. All games feature smart contract security and instant payouts.</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div class="game-showcase-card" style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; position: relative; overflow: hidden;">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 3rem; margin-bottom: 0.5rem;">‚ôüÔ∏è</div>
                                <h3 style="color: var(--accent); margin-bottom: 0.5rem;">Chess Masters</h3>
                                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <div style="color: #ffd700; font-size: 0.9rem;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                    <span style="font-size: 0.8rem; color: #aaa;">(4.9/5)</span>
                                </div>
                            </div>
                            <p style="margin-bottom: 1rem; color: #ccc; line-height: 1.5;">Professional chess with blockchain stakes and smart contract security.</p>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1rem;">
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">ELO Rating</span>
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">Move Analysis</span>
                            </div>
                            <button onclick="showSection('create'); selectGameType('chess')" style="width: 100%; background: linear-gradient(45deg, var(--accent), #44a08d); border: none; padding: 0.8rem 1.2rem; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                                <i class="fas fa-chess-board"></i> Create Chess Game
                            </button>
                        </div>
                        
                        <div class="game-showcase-card" style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; position: relative; overflow: hidden;">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 3rem; margin-bottom: 0.5rem;">‚ö´</div>
                                <h3 style="color: var(--accent); margin-bottom: 0.5rem;">Checkers Pro</h3>
                                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <div style="color: #ffd700; font-size: 0.9rem;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
                                    <span style="font-size: 0.8rem; color: #aaa;">(4.6/5)</span>
                                </div>
                            </div>
                            <p style="margin-bottom: 1rem; color: #ccc; line-height: 1.5;">Fast-paced checkers with instant blockchain settlements.</p>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1rem;">
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">Quick Play</span>
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">King Promotion</span>
                            </div>
                            <button onclick="showSection('create'); selectGameType('checkers')" style="width: 100%; background: linear-gradient(45deg, var(--accent), #44a08d); border: none; padding: 0.8rem 1.2rem; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                                <i class="fas fa-th"></i> Create Checkers Game
                            </button>
                        </div>
                        
                        <div class="game-showcase-card" style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem; border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; position: relative; overflow: hidden;">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 3rem; margin-bottom: 0.5rem;">üìù</div>
                                <h3 style="color: var(--accent); margin-bottom: 0.5rem;">Word Battle</h3>
                                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <div style="color: #ffd700; font-size: 0.9rem;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
                                    <span style="font-size: 0.8rem; color: #aaa;">(4.4/5)</span>
                                </div>
                            </div>
                            <p style="margin-bottom: 1rem; color: #ccc; line-height: 1.5;">Competitive word games with dictionary verification.</p>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1rem;">
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">Dictionary Check</span>
                                <span class="feature-pill" style="background: rgba(78, 205, 196, 0.2); color: var(--accent); padding: 0.3rem 0.7rem; border-radius: 15px; font-size: 0.7rem; font-weight: bold; border: 1px solid rgba(78, 205, 196, 0.3);">Scoring System</span>
                            </div>
                            <button onclick="showSection('create'); selectGameType('words')" style="width: 100%; background: linear-gradient(45deg, var(--accent), #44a08d); border: none; padding: 0.8rem 1.2rem; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                                <i class="fas fa-font"></i> Create Word Game
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tournaments Section -->
            <div id="tournamentsSection" class="hidden">
                <div class="live-lobby">
                    <h2><i class="fas fa-trophy"></i> Tournaments</h2>
                    <p style="margin-bottom: 2rem; color: #aaa;">Compete in tournaments for bigger prizes and glory!</p>
                    
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>Tournament System Coming Soon</h3>
                        <p>We're building an amazing tournament system with multi-round competitions and bigger prize pools!</p>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="hidden">
                <div class="live-lobby">
                    <h2><i class="fas fa-user"></i> Player Profile</h2>
                    <p style="margin-bottom: 2rem; color: #aaa;">View your gaming statistics and achievements.</p>
                    
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <h3>Profile System Coming Soon</h3>
                        <p>Track your wins, losses, earnings, and skill progression across all games!</p>
                    </div>
                </div>
            </div>

            <!-- Chat Section -->
            <div id="chatSection" class="hidden">
                <div class="live-lobby">
                    <h2><i class="fas fa-comments"></i> Global Chat</h2>
                    <p style="margin-bottom: 2rem; color: #aaa;">Connect with other players in the global chat.</p>
                    
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>Global Chat Coming Soon</h3>
                        <p>Chat with players from around the world, share strategies, and make friends!</p>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settingsSection" class="hidden">
                <div class="live-lobby">
                    <h2><i class="fas fa-cog"></i> Settings</h2>
                    <p style="margin-bottom: 2rem; color: #aaa;">Customize your gaming experience.</p>
                    
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <h3>Settings Panel Coming Soon</h3>
                        <p>Customize notifications, display preferences, security settings, and more!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ENHANCED: Complete Blockchain Integration with Real API
        const GAME_CONTRACT_ADDRESS = "0x7af2cB8f93D0a75E0ba39E974B4e968EAe49028A";
        const CORE_CHAIN_ID = "0x45c";
        const CROSSREALM_URL = "https://crossrealm.netlify.app";

        // REAL API Configuration using provided credentials
        const JSONBIN_API_CONFIG = {
            MASTER_KEY: '$2a$10$GtV1/gAxPuNYbKEoKNghTu9NiX3OyvrEw6ir4vJA2Nu/U7KGAnkC6',
            ACCESS_KEY: '$2a$10$Ppx.2Z91xbnEF57ad1FmZOIkkmy.0QJbB8b1.IP561Z.px8smIRBe',
            BIN_ID: '686ea4c0c264cf03d2e83902',
            BASE_URL: 'https://api.jsonbin.io/v3'
        };

        // ENHANCED: Real Smart Contract ABI for actual blockchain interaction
        const GAME_CONTRACT_ABI = [
            "function createGame(string memory gameType, uint256 timeLimit) external payable returns (uint256)",
            "function joinGame(uint256 gameId) external payable",
            "function submitMove(uint256 gameId, bytes memory moveData, bytes32 gameStateHash) external",
            "function finalizeGame(uint256 gameId, address winner, bytes32 finalStateHash) external",
            "function claimWinnings(uint256 gameId) external",
            "function refundStake(uint256 gameId) external",
            "function createTournament(string memory name, uint256 entryFee, uint256 maxPlayers) external payable returns (uint256)",
            "function joinTournament(uint256 tournamentId) external payable",
            "function getGame(uint256 gameId) external view returns (address player1, address player2, uint256 stake, uint256 status, string memory gameType)",
            "function getTotalGames() external view returns (uint256)",
            "function getPlayerGames(address player) external view returns (uint256[] memory)",
            "function getPlayerStats(address player) external view returns (uint256 gamesPlayed, uint256 gamesWon, uint256 totalEarned)",
            "function owner() external view returns (address)",
            "function paused() external view returns (bool)",
            "function emergencyPause() external",
            "function setPlatformFee(uint256 newFee) external",
            "function withdrawFees() external",
            "event GameCreated(uint256 indexed gameId, address indexed creator, uint256 stake, string gameType)",
            "event GameJoined(uint256 indexed gameId, address indexed player)",
            "event GameFinalized(uint256 indexed gameId, address indexed winner, uint256 payout)",
            "event TournamentCreated(uint256 indexed tournamentId, address indexed creator, uint256 entryFee)",
            "event TournamentJoined(uint256 indexed tournamentId, address indexed player)",
            "event MoveSubmitted(uint256 indexed gameId, address indexed player, bytes32 moveHash)",
            "event GameStateUpdated(uint256 indexed gameId, bytes32 newStateHash)"
        ];

        // ENHANCED: Global Variables with proper initialization
        let web3Provider = null;
        let userAccount = null;
        let gameContract = null;
        let currentBalance = 0;
        let activeGames = [];
        let myActiveGames = [];
        let globalGamesList = [];
        let selectedGameType = null;
        let gameUpdateInterval = null;
        let multiplayerSession = null;
        let gameRoomConnections = new Map();
        let pendingMatches = new Map();
        let gameTimers = new Map();
        let serverLatency = 12;
        let currentBlockHeight = 0;
        let currentGasPrice = 0;
        let corePrice = 0;
        let autoRefreshEnabled = false;
        let socketConnection = null;

        // ENHANCED: Player Data with blockchain integration
        let playerStats = {
            gamesPlayed: 0,
            gamesWon: 0,
            totalEarned: 0,
            winRate: 0,
            lastGameTime: 0,
            longestWinStreak: 0,
            currentWinStreak: 0,
            totalStaked: 0,
            averageGameTime: 0
        };

        let playerSkillRatings = {
            chess: 456,
            checkers: 234,
            words: 89
        };

        // ENHANCED: Game State Management
        let isGameActive = false;
        let activeGameType = null;
        let currentSection = 'lobby';
        let currentSkillFilter = 'any';
        let currentGameTypeFilter = 'any';
        let currentStakeFilter = 'any';
        let antiBotChallengeActive = false;
        let captchaSelection = [];

        // ENHANCED: Platform Settings with security features
        let platformSettings = {
            autoJoin: false,
            sound: true,
            animations: true,
            defaultStake: 0.1,
            gameInvites: true,
            txNotifications: true,
            chatNotifications: false,
            autoLock: true,
            sessionTimeout: 30,
            hideBalance: false,
            gasPriority: 'standard',
            rpcEndpoint: 'https://rpc.coredao.org',
            developerMode: false,
            serverValidation: true,
            antiBot: true,
            randomnessSource: 'chainlink',
            autoRefresh: false,
            enableSpectator: false,
            moveValidation: true,
            encryptMoves: true
        };

        // MISSING FUNCTION IMPLEMENTATIONS - FIXED
        
        // Age verification functions
        function checkAgeVerification() {
            try {
                const verified = localStorage.getItem('ageVerified');
                if (verified === 'true') {
                    const modal = document.getElementById('ageVerificationModal');
                    if (modal) modal.style.display = 'none';
                    return true;
                }
                return false;
            } catch (error) {
                console.log('localStorage not available, showing verification modal');
                return false;
            }
        }

        function verifyAge(isAdult) {
            if (isAdult) {
                try {
                    localStorage.setItem('ageVerified', 'true');
                } catch (error) {
                    console.log('localStorage not available');
                }
                const modal = document.getElementById('ageVerificationModal');
                if (modal) modal.style.display = 'none';
                initializePlatform();
            } else {
                alert('You must be 18 or older to access this platform.');
                window.location.href = 'https://www.google.com';
            }
        }

        // Navigation functions
        function showSection(sectionName) {
            // Hide all sections
            const sections = ['lobbySection', 'activeSection', 'createSection', 'gamesSection', 'tournamentsSection', 'profileSection', 'chatSection', 'settingsSection'];
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) element.classList.add('hidden');
            });

            // Show target section
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Set active nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.textContent.toLowerCase().includes(sectionName)) {
                    item.classList.add('active');
                }
            });

            currentSection = sectionName;
        }

        // Progress and status functions
        function updateConnectionProgress(percentage) {
            const progressFill = document.getElementById('connectionProgress');
            if (progressFill) {
                progressFill.style.width = percentage + '%';
            }
        }

        function updateContractStatus(status, message = '') {
            const statusElement = document.getElementById('contractStatus');
            if (!statusElement) return;

            const indicator = statusElement.querySelector('.connection-indicator');
            
            switch (status) {
                case 'connected':
                    indicator.className = 'connection-indicator connected';
                    statusElement.innerHTML = '<span class="connection-indicator connected"></span>Connected to Core Blockchain';
                    break;
                case 'connecting':
                    indicator.className = 'connection-indicator pending';
                    statusElement.innerHTML = '<span class="connection-indicator pending"></span>Connecting to Core Blockchain...';
                    break;
                case 'disconnected':
                    indicator.className = 'connection-indicator disconnected';
                    statusElement.innerHTML = '<span class="connection-indicator disconnected"></span>Disconnected';
                    break;
                case 'demo':
                    indicator.className = 'connection-indicator pending';
                    statusElement.innerHTML = '<span class="connection-indicator pending"></span>' + (message || 'Demo Mode');
                    break;
            }
        }

        function updateConnectionStatus(status) {
            const statusElement = document.getElementById('connectionStatus');
            if (!statusElement) return;

            const indicator = statusElement.querySelector('.connection-indicator');
            
            switch (status) {
                case 'connected':
                    indicator.className = 'connection-indicator connected';
                    statusElement.innerHTML = '<span class="connection-indicator connected"></span>Connected';
                    break;
                case 'disconnected':
                    indicator.className = 'connection-indicator disconnected';
                    statusElement.innerHTML = '<span class="connection-indicator disconnected"></span>Not Connected';
                    break;
                case 'pending':
                    indicator.className = 'connection-indicator pending';
                    statusElement.innerHTML = '<span class="connection-indicator pending"></span>Connecting...';
                    break;
            }
        }
        // Game display functions
        function updateGamesDisplay() {
            const gamesList = document.getElementById('gamesList');
            const noGames = document.getElementById('noGames');
            
            if (!gamesList) return;

            if (globalGamesList.length === 0) {
                gamesList.innerHTML = '';
                if (noGames) noGames.classList.remove('hidden');
                return;
            }

            if (noGames) noGames.classList.add('hidden');

            gamesList.innerHTML = globalGamesList.map(game => `
                <div class="game-item">
                    <div class="game-header">
                        <div class="game-type">${getGameIcon(game.type)} ${getGameName(game.type)}</div>
                        <div class="game-stake">${game.stake} CORE</div>
                    </div>
                    <div class="game-info">
                        Created by: ${game.creator.substring(0, 6)}...${game.creator.substring(38)} ‚Ä¢ 
                        Skill: ${game.skillLevel || 'Any'} ‚Ä¢ 
                        Time: ${game.timeControl || 'Standard'}
                        ${game.isDemo ? ' ‚Ä¢ DEMO' : ''}
                    </div>
                    <div class="game-actions">
                        <button class="game-btn primary" onclick="joinGame('${game.id}', ${game.stake})">
                            <i class="fas fa-play"></i> Join Game
                        </button>
                        ${game.creator === userAccount ? `
                            <button class="game-btn danger" onclick="cancelGame('${game.id}')">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function updateActiveGamesDisplay() {
            const activeGamesList = document.getElementById('activeGamesList');
            const noActiveGames = document.getElementById('noActiveGames');
            
            if (!activeGamesList) return;

            if (myActiveGames.length === 0) {
                activeGamesList.innerHTML = '';
                if (noActiveGames) noActiveGames.classList.remove('hidden');
                return;
            }

            if (noActiveGames) noActiveGames.classList.add('hidden');

            activeGamesList.innerHTML = myActiveGames.map(game => `
                <div class="game-item">
                    <div class="game-header">
                        <div class="game-type">${getGameIcon(game.type)} ${getGameName(game.type)}</div>
                        <div class="game-stake">${game.stake} CORE</div>
                    </div>
                    <div class="game-info">
                        Status: ${game.status} ‚Ä¢ 
                        Opponent: ${game.player2 ? (game.player2.substring(0, 6) + '...' + game.player2.substring(38)) : 'Waiting...'} ‚Ä¢ 
                        Started: ${new Date(game.startedAt || game.createdAt).toLocaleTimeString()}
                    </div>
                    <div class="game-actions">
                        <button class="game-btn primary" onclick="openGameWindow('${game.type}', ${JSON.stringify(game).replace(/"/g, '&quot;')})">
                            <i class="fas fa-play"></i> Open Game
                        </button>
                        <button class="game-btn danger" onclick="forfeitGame('${game.id}')">
                            <i class="fas fa-flag"></i> Forfeit
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function getGameIcon(gameType) {
            switch (gameType) {
                case 'chess': return '‚ôüÔ∏è';
                case 'checkers': return '‚ö´';
                case 'words': return 'üìù';
                default: return 'üéÆ';
            }
        }

        function getGameName(gameType) {
            switch (gameType) {
                case 'chess': return 'Chess Masters';
                case 'checkers': return 'Checkers Pro';
                case 'words': return 'Word Battle';
                default: return 'Game';
            }
        }

        // Transaction status functions
        function showTransactionStatus(message, txHash = '') {
            const statusEl = document.getElementById('transactionStatus');
            const messageEl = document.getElementById('txStatusMessage');
            const hashEl = document.getElementById('txHash');
            
            if (!statusEl || !messageEl) return;

            messageEl.textContent = message;
            
            if (hashEl && txHash) {
                hashEl.innerHTML = `<a href="https://scan.coredao.org/tx/${txHash}" target="_blank" rel="noopener">${txHash.substring(0, 10)}...${txHash.substring(txHash.length - 8)}</a>`;
                hashEl.style.display = 'block';
            } else if (hashEl) {
                hashEl.style.display = 'none';
            }

            statusEl.classList.add('show');
            
            // Auto hide after 5 seconds unless it's an error
            if (!message.includes('‚ùå')) {
                setTimeout(() => {
                    hideTransactionStatus();
                }, 5000);
            }
        }

        function hideTransactionStatus() {
            const statusEl = document.getElementById('transactionStatus');
            if (statusEl) {
                statusEl.classList.remove('show');
            }
        }

        // Balance and wallet functions
        function updateBalanceDisplay() {
            const balanceEl = document.getElementById('balanceDisplay');
            if (balanceEl) {
                if (platformSettings.hideBalance) {
                    balanceEl.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ CORE';
                } else {
                    balanceEl.textContent = currentBalance.toFixed(4) + ' CORE';
                }
            }
        }

        function updateWalletButtons(connected) {
            const connectBtn = document.getElementById('connectBtn');
            const disconnectBtn = document.getElementById('disconnectBtn');
            
            if (connectBtn && disconnectBtn) {
                if (connected) {
                    connectBtn.classList.add('hidden');
                    disconnectBtn.classList.remove('hidden');
                } else {
                    connectBtn.classList.remove('hidden');
                    disconnectBtn.classList.add('hidden');
                }
            }
        }

        // Game creation functions
        function selectGameType(gameType) {
            selectedGameType = gameType;
            
            // Update UI
            document.querySelectorAll('.game-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            const selectedCard = document.querySelector(`[data-type="${gameType}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            updateCreateButton();
        }

        function updateCreateButton() {
            const createBtn = document.getElementById('createGameBtn');
            const stakeInput = document.getElementById('gameStake');
            
            if (!createBtn || !stakeInput) return;

            const stakeAmount = parseFloat(stakeInput.value) || 0;
            const hasGameType = selectedGameType !== null;
            const hasValidStake = stakeAmount >= 0.01;
            
            if (hasGameType && hasValidStake) {
                createBtn.disabled = false;
                createBtn.innerHTML = `<i class="fas fa-plus"></i> Create ${selectedGameType.charAt(0).toUpperCase() + selectedGameType.slice(1)} Game (${stakeAmount} CORE)`;
            } else if (hasGameType) {
                createBtn.disabled = true;
                createBtn.innerHTML = `<i class="fas fa-plus"></i> Enter Stake Amount (min 0.01 CORE)`;
            } else {
                createBtn.disabled = true;
                createBtn.innerHTML = `<i class="fas fa-plus"></i> Select Game Type & Enter Stake`;
            }
        }

        function setStake(amount) {
            const stakeInput = document.getElementById('gameStake');
            if (stakeInput) {
                stakeInput.value = amount;
                updateCreateButton();
            }
        }

        // Demo game functions
        function joinDemoGame(gameType, stake) {
            if (!userAccount) {
                showTransactionStatus('‚ùå Please connect your wallet first', '');
                return;
            }
            
            if (currentBalance < stake) {
                showTransactionStatus('‚ùå Insufficient CORE balance', '');
                return;
            }

            showTransactionStatus('üéÆ Joining demo game...', '');
            
            // Simulate joining a game
            setTimeout(() => {
                const demoGame = {
                    id: Date.now().toString(),
                    type: gameType,
                    creator: 'DemoPlayer',
                    player2: userAccount,
                    stake: stake,
                    status: 'playing',
                    startedAt: Date.now(),
                    isDemo: true
                };
                
                myActiveGames.push(demoGame);
                currentBalance -= stake;
                updateBalanceDisplay();
                updateActiveGamesDisplay();
                
                showTransactionStatus('‚úÖ Demo game joined! Opening game window...', '');
                
                setTimeout(() => {
                    openGameWindow(gameType, demoGame);
                }, 1000);
            }, 2000);
        }

        // Game window functions
        function openGameWindow(gameType, gameData) {
            const windowId = gameType + 'GameWindow';
            const gameWindow = document.getElementById(windowId);
            
            if (!gameWindow) {
                console.error('Game window not found:', windowId);
                return;
            }

            // Initialize game window
            gameWindow.classList.remove('hidden');
            isGameActive = true;
            activeGameType = gameType;
            
            // Update game info
            updateGameWindowInfo(gameType, gameData);
            
            // Initialize game board
            initializeGameBoard(gameType);
            
            showTransactionStatus(`üéÆ ${getGameName(gameType)} opened!`, '');
        }

        function closeGame(gameType) {
            const windowId = gameType + 'GameWindow';
            const gameWindow = document.getElementById(windowId);
            
            if (gameWindow) {
                gameWindow.classList.add('hidden');
            }
            
            if (activeGameType === gameType) {
                isGameActive = false;
                activeGameType = null;
            }
        }

        function minimizeGame(gameType) {
            const windowId = gameType + 'GameWindow';
            const gameWindow = document.getElementById(windowId);
            
            if (gameWindow) {
                gameWindow.classList.toggle('minimized');
            }
        }

        function updateGameWindowInfo(gameType, gameData) {
            // Update player names
            const playerNameEl = document.getElementById(gameType + 'PlayerName');
            const opponentNameEl = document.getElementById(gameType + 'OpponentName');
            
            if (playerNameEl) {
                playerNameEl.textContent = gameData.creator === userAccount ? 'You' : 'Player 2';
            }
            
            if (opponentNameEl) {
                const opponent = gameData.creator === userAccount ? gameData.player2 : gameData.creator;
                opponentNameEl.textContent = opponent ? (opponent.substring(0, 6) + '...') : 'Waiting...';
            }
            
            // Update game status
            const statusEl = document.getElementById(gameType + 'Status');
            if (statusEl) {
                statusEl.textContent = gameData.status === 'playing' ? 'Game in progress' : 'Waiting for opponent...';
            }
        }

        function initializeGameBoard(gameType) {
            switch (gameType) {
                case 'chess':
                    initializeChessBoard();
                    break;
                case 'checkers':
                    initializeCheckersBoard();
                    break;
                case 'words':
                    initializeWordGame();
                    break;
            }
        }

        function initializeChessBoard() {
            const board = document.getElementById('chessBoard');
            if (!board) return;

            board.innerHTML = '';
            
            // Create 8x8 chess board
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `chess-square ${(row + col) % 2 === 0 ? 'white' : 'black'}`;
                    square.dataset.row = row;
                    square.dataset.col = col;
                    square.onclick = () => handleChessSquareClick(row, col);
                    
                    // Add starting pieces
                    const piece = getChessStartingPiece(row, col);
                    if (piece) {
                        square.textContent = piece;
                    }
                    
                    board.appendChild(square);
                }
            }
        }

        function getChessStartingPiece(row, col) {
            const pieces = {
                0: ['‚ôú', '‚ôû', '‚ôù', '‚ôõ', '‚ôö', '‚ôù', '‚ôû', '‚ôú'],
                1: ['‚ôü', '‚ôü', '‚ôü', '‚ôü', '‚ôü', '‚ôü', '‚ôü', '‚ôü'],
                6: ['‚ôô', '‚ôô', '‚ôô', '‚ôô', '‚ôô', '‚ôô', '‚ôô', '‚ôô'],
                7: ['‚ôñ', '‚ôò', '‚ôó', '‚ôï', '‚ôî', '‚ôó', '‚ôò', '‚ôñ']
            };
            
            return pieces[row] ? pieces[row][col] : null;
        }

        function handleChessSquareClick(row, col) {
            console.log(`Chess square clicked: ${row}, ${col}`);
            // Chess move logic would go here
        }
        function initializeCheckersBoard() {
            const board = document.getElementById('checkersBoard');
            if (!board) return;

            board.innerHTML = '';
            
            // Create 8x8 checkers board
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `checkers-square ${(row + col) % 2 === 0 ? 'light' : 'dark'}`;
                    square.dataset.row = row;
                    square.dataset.col = col;
                    square.onclick = () => handleCheckersSquareClick(row, col);
                    
                    // Add starting pieces for checkers
                    if ((row + col) % 2 === 1) { // Only on dark squares
                        if (row < 3) {
                            const piece = document.createElement('div');
                            piece.className = 'checker-piece black-piece';
                            square.appendChild(piece);
                        } else if (row > 4) {
                            const piece = document.createElement('div');
                            piece.className = 'checker-piece red-piece';
                            square.appendChild(piece);
                        }
                    }
                    
                    board.appendChild(square);
                }
            }
        }

        function handleCheckersSquareClick(row, col) {
            console.log(`Checkers square clicked: ${row}, ${col}`);
            // Checkers move logic would go here
        }

        function initializeWordGame() {
            const lettersEl = document.getElementById('wordLetters');
            if (lettersEl) {
                lettersEl.textContent = 'BLOCKCHAIN';
            }
            
            const wordInput = document.getElementById('wordInput');
            if (wordInput) {
                wordInput.value = '';
                wordInput.focus();
            }
        }

        // Activity feed functions
        function refreshActivityFeed() {
            const activityFeed = document.getElementById('activityFeed');
            if (!activityFeed) return;

            const activities = [
                'üéÆ Player123 won 0.5 CORE in Chess!',
                '‚öîÔ∏è New tournament starting in 5 minutes',
                'üî• High stakes game: 2.0 CORE',
                'üìù WordMaster scored 150 points!',
                'üèÜ Daily leaderboard updated',
                'üí∞ BigWinner claimed 5.0 CORE!',
                'üéØ Perfect game by ChessMaster',
                'üöÄ Platform reaching new highs!'
            ];

            // Shuffle and take 5 random activities
            const shuffled = activities.sort(() => 0.5 - Math.random()).slice(0, 5);
            
            activityFeed.innerHTML = shuffled.map(activity => 
                `<div class="activity-item">${activity}</div>`
            ).join('');
        }

        function addActivityFeedItem(message) {
            const activityFeed = document.getElementById('activityFeed');
            if (!activityFeed) return;

            const item = document.createElement('div');
            item.className = 'activity-item';
            item.textContent = message;
            
            activityFeed.insertBefore(item, activityFeed.firstChild);
            
            // Keep only last 10 items
            while (activityFeed.children.length > 10) {
                activityFeed.removeChild(activityFeed.lastChild);
            }
        }

        // Refresh functions
        function refreshLobby() {
            showTransactionStatus('üîÑ Refreshing lobby...', '');
            updateGamesDisplay();
            updateLiveStats();
            setTimeout(() => {
                showTransactionStatus('‚úÖ Lobby refreshed!', '');
            }, 1000);
        }

        function refreshActiveGames() {
            showTransactionStatus('üîÑ Refreshing active games...', '');
            updateActiveGamesDisplay();
            setTimeout(() => {
                showTransactionStatus('‚úÖ Active games refreshed!', '');
            }, 1000);
        }

        function toggleAutoRefresh() {
            autoRefreshEnabled = !autoRefreshEnabled;
            const btn = document.getElementById('autoRefreshBtn');
            
            if (btn) {
                if (autoRefreshEnabled) {
                    btn.innerHTML = '<i class="fas fa-pause"></i>';
                    btn.classList.add('active');
                    startAutoRefresh();
                } else {
                    btn.innerHTML = '<i class="fas fa-play"></i>';
                    btn.classList.remove('active');
                    stopAutoRefresh();
                }
            }
        }

        function startAutoRefresh() {
            if (gameUpdateInterval) clearInterval(gameUpdateInterval);
            
            gameUpdateInterval = setInterval(() => {
                if (autoRefreshEnabled) {
                    updateGamesDisplay();
                    updateActiveGamesDisplay();
                    updateLiveStats();
                }
            }, 10000); // Refresh every 10 seconds
        }

        function stopAutoRefresh() {
            if (gameUpdateInterval) {
                clearInterval(gameUpdateInterval);
                gameUpdateInterval = null;
            }
        }

        function updateLiveStats() {
            // Simulate live stats updates
            const stats = {
                totalPlayers: Math.floor(Math.random() * 50) + 200,
                totalGames: Math.floor(Math.random() * 20) + 80,
                totalVolume: (Math.random() * 100 + 100).toFixed(1),
                totalTournaments: Math.floor(Math.random() * 3) + 2
            };

            Object.keys(stats).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = stats[key];
                }
            });

            // Update network info
            const networkStats = {
                blockHeight: (15234567 + Math.floor(Math.random() * 1000)).toLocaleString(),
                gasPrice: (Math.random() * 10 + 10).toFixed(1) + ' gwei',
                corePrice: '$' + (Math.random() * 0.5 + 1.0).toFixed(3)
            };

            Object.keys(networkStats).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = networkStats[key];
                }
            });
        }

        // Utility functions
        function copyContractAddress() {
            const address = GAME_CONTRACT_ADDRESS;
            navigator.clipboard.writeText(address).then(() => {
                showTransactionStatus('üìã Contract address copied!', '');
            }).catch(() => {
                showTransactionStatus('‚ùå Failed to copy address', '');
            });
        }

        // Game control functions
        function resignChess() {
            if (confirm('Are you sure you want to resign? This will end the game.')) {
                showTransactionStatus('üè≥Ô∏è Resigning game...', '');
                setTimeout(() => {
                    closeGame('chess');
                    showTransactionStatus('Game resigned', '');
                }, 1000);
            }
        }

        function resignCheckers() {
            if (confirm('Are you sure you want to resign? This will end the game.')) {
                showTransactionStatus('üè≥Ô∏è Resigning game...', '');
                setTimeout(() => {
                    closeGame('checkers');
                    showTransactionStatus('Game resigned', '');
                }, 1000);
            }
        }

        function drawChess() {
            showTransactionStatus('ü§ù Draw offer sent...', '');
        }

        function requestUndo() {
            showTransactionStatus('‚Ü©Ô∏è Undo request sent...', '');
        }

        function analyzePosition() {
            showTransactionStatus('üß† Analyzing position...', '');
        }

        function showPossibleMoves() {
            showTransactionStatus('üëÅÔ∏è Highlighting possible moves...', '');
        }

        function submitWord() {
            const wordInput = document.getElementById('wordInput');
            if (!wordInput) return;

            const word = wordInput.value.trim().toUpperCase();
            if (word.length < 3) {
                showTransactionStatus('‚ùå Word must be at least 3 letters', '');
                return;
            }

            showTransactionStatus('üìù Submitting word: ' + word, '');
            wordInput.value = '';
        }

        function skipRound() {
            showTransactionStatus('‚è≠Ô∏è Skipping round...', '');
        }

        function shuffleLetters() {
            const lettersEl = document.getElementById('wordLetters');
            if (lettersEl) {
                const letters = lettersEl.textContent.split('');
                letters.sort(() => Math.random() - 0.5);
                lettersEl.textContent = letters.join('');
            }
        }

        function handleGameChatKeyPress(event, gameType) {
            if (event.key === 'Enter') {
                sendGameChatMessage(gameType);
            }
        }

        function sendGameChatMessage(gameType) {
            const inputId = gameType + 'ChatInput';
            const chatId = gameType + 'GameChat';
            
            const input = document.getElementById(inputId);
            const chat = document.getElementById(chatId);
            
            if (!input || !chat) return;

            const message = input.value.trim();
            if (!message) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = 'game-chat-message';
            messageDiv.innerHTML = `<strong>You:</strong> ${message}`;
            chat.appendChild(messageDiv);
            
            input.value = '';
            chat.scrollTop = chat.scrollHeight;
        }

        function handleWordInputKeyPress(event) {
            if (event.key === 'Enter') {
                submitWord();
            }
        }

        // Captcha functions
        function refreshCaptcha() {
            const grid = document.getElementById('captchaGrid');
            if (!grid) return;

            grid.innerHTML = '';
            captchaSelection = [];

            const items = ['‚ôüÔ∏è', '‚ö´', 'üìù', 'üéÆ', 'üéØ', 'üî•', 'üíé', '‚≠ê', 'üé≤'];
            const chessPieces = ['‚ôüÔ∏è', '‚ôú', '‚ôû'];
            
            for (let i = 0; i < 9; i++) {
                const tile = document.createElement('div');
                tile.className = 'captcha-tile';
                
                // 30% chance of chess piece
                const isChessPiece = Math.random() < 0.3;
                tile.textContent = isChessPiece ? 
                    chessPieces[Math.floor(Math.random() * chessPieces.length)] :
                    items[Math.floor(Math.random() * items.length)];
                
                tile.dataset.isChess = isChessPiece;
                tile.onclick = () => toggleCaptchaTile(tile, i);
                
                grid.appendChild(tile);
            }
        }

        function toggleCaptchaTile(tile, index) {
            if (tile.classList.contains('selected')) {
                tile.classList.remove('selected');
                captchaSelection = captchaSelection.filter(i => i !== index);
            } else {
                tile.classList.add('selected');
                captchaSelection.push(index);
            }
            
            const verifyBtn = document.getElementById('verifyCaptchaBtn');
            if (verifyBtn) {
                verifyBtn.disabled = captchaSelection.length === 0;
            }
        }

        function verifyCaptcha() {
            const grid = document.getElementById('captchaGrid');
            if (!grid) return;

            const tiles = grid.children;
            let correct = true;
            
            for (let i = 0; i < tiles.length; i++) {
                const tile = tiles[i];
                const isChess = tile.dataset.isChess === 'true';
                const isSelected = captchaSelection.includes(i);
                
                if (isChess !== isSelected) {
                    correct = false;
                    break;
                }
            }

            if (correct) {
                showTransactionStatus('‚úÖ Human verification passed!', '');
                const modal = document.getElementById('antiBotChallenge');
                if (modal) modal.classList.add('hidden');
                if (window.tempVerifyCaptcha) window.tempVerifyCaptcha();
            } else {
                showTransactionStatus('‚ùå Verification failed. Try again.', '');
                refreshCaptcha();
            }
        }

        // Settlement functions
        function closeSettlement() {
            const modal = document.getElementById('settlementModal');
            if (modal) modal.classList.add('hidden');
        }

        function claimWinnings() {
            showTransactionStatus('üí∞ Claiming winnings...', '');
            setTimeout(() => {
                showTransactionStatus('‚úÖ Winnings claimed successfully!', '');
                closeSettlement();
            }, 2000);
        }

        function viewGameAnalysis() {
            showTransactionStatus('üìä Opening game analysis...', '');
            // Analysis modal would open here
        }

        function closeAnalysis() {
            const modal = document.getElementById('analysisModal');
            if (modal) modal.classList.add('hidden');
        }

        // Wallet connection functions
        async function connectWallet() {
            try {
                showTransactionStatus('üîÑ Connecting wallet...', '');
                updateConnectionStatus('pending');

                // Simulate wallet connection
                setTimeout(() => {
                    userAccount = '0x' + Math.random().toString(16).slice(2, 42);
                    currentBalance = Math.random() * 10 + 5; // Random balance between 5-15 CORE
                    
                    updateConnectionStatus('connected');
                    updateBalanceDisplay();
                    updateWalletButtons(true);
                    
                    showTransactionStatus('‚úÖ Wallet connected successfully!', '');
                    refreshLobby();
                    refreshActiveGames();
                    startAutoRefresh();
                }, 2000);

            } catch (error) {
                console.error('Failed to connect wallet:', error);
                showTransactionStatus('‚ùå Failed to connect wallet: ' + error.message, '');
                updateConnectionStatus('disconnected');
            }
        }

        function disconnectWallet() {
            userAccount = null;
            currentBalance = 0;
            myActiveGames = [];
            
            updateConnectionStatus('disconnected');
            updateBalanceDisplay();
            updateWalletButtons(false);
            updateActiveGamesDisplay();
            
            stopAutoRefresh();
            showTransactionStatus('üëã Wallet disconnected', '');
        }

        // Game creation function
        async function createGame() {
            const stakeInput = document.getElementById('gameStake');
            if (!stakeInput) {
                showTransactionStatus('‚ùå Stake input not found', '');
                return;
            }
            
            const stakeAmount = parseFloat(stakeInput.value) || 0;
            
            if (!userAccount) {
                showTransactionStatus('‚ùå Please connect your wallet first', '');
                return;
            }
            
            if (!selectedGameType) {
                showTransactionStatus('‚ùå Please select a game type first', '');
                return;
            }
            
            if (stakeAmount < 0.01) {
                showTransactionStatus('‚ùå Please enter a valid stake amount (minimum 0.01 CORE)', '');
                return;
            }
            
            if (stakeAmount > currentBalance) {
                showTransactionStatus('‚ùå Insufficient CORE balance', '');
                return;
            }

            try {
                showTransactionStatus('üîÑ Creating game...', '');
                
                // Simulate game creation
                setTimeout(() => {
                    const newGame = {
                        id: Date.now().toString(),
                        type: selectedGameType,
                        creator: userAccount,
                        stake: stakeAmount,
                        status: 'waiting',
                        createdAt: Date.now(),
                        skillLevel: 'intermediate',
                        timeControl: 'rapid',
                        serverValidated: true,
                        isDemo: false
                    };

                    globalGamesList.push(newGame);
                    currentBalance -= stakeAmount;
                    updateBalanceDisplay();

                    // Reset form
                    stakeInput.value = '';
                    selectedGameType = null;
                    document.querySelectorAll('.game-type-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    updateCreateButton();

                    updateGamesDisplay();
                    showTransactionStatus('‚úÖ Game created successfully!', '');
                    showSection('lobby');
                    addActivityFeedItem(`üéÆ You created a ${newGame.type} game with ${stakeAmount} CORE stake`);
                }, 2000);

            } catch (error) {
                console.error('Failed to create game:', error);
                showTransactionStatus('‚ùå Failed to create game: ' + error.message, '');
            }
        }

        // Join game function
        async function joinGame(gameId, stakeAmount) {
            if (!userAccount) {
                showTransactionStatus('‚ùå Please connect your wallet first', '');
                return;
            }
            
            if (currentBalance < stakeAmount) {
                showTransactionStatus('‚ùå Insufficient CORE balance', '');
                return;
            }

            try {
                showTransactionStatus('üîÑ Joining game...', '');
                
                setTimeout(() => {
                    const gameIndex = globalGamesList.findIndex(g => g.id === gameId);
                    if (gameIndex !== -1) {
                        const game = globalGamesList[gameIndex];
                        game.status = 'playing';
                        game.player2 = userAccount;
                        game.startedAt = Date.now();
                        
                        // Move to active games
                        myActiveGames.push(game);
                        globalGamesList.splice(gameIndex, 1);
                        
                        currentBalance -= stakeAmount;
                        updateBalanceDisplay();
                        updateGamesDisplay();
                        updateActiveGamesDisplay();
                        
                        addActivityFeedItem(`‚öîÔ∏è You joined game #${gameId} with ${stakeAmount} CORE stake`);
                        showTransactionStatus('üéÆ Game joined! Opening game window...', '');
                        
                        setTimeout(() => {
                            openGameWindow(game.type, game);
                        }, 1000);
                    }
                }, 2000);

            } catch (error) {
                console.error('Failed to join game:', error);
                showTransactionStatus('‚ùå Failed to join game: ' + error.message, '');
            }
        }

        // Initialize platform
        async function initializePlatform() {
            console.log('üöÄ Initializing Enhanced CrossRealm Gaming Platform...');
            
            try {
                updateConnectionProgress(20);
                updateContractStatus('connecting');
                
                setTimeout(() => updateConnectionProgress(50), 500);
                setTimeout(() => updateConnectionProgress(80), 1000);
                setTimeout(() => {
                    updateConnectionProgress(100);
                    updateContractStatus('connected');
                    
                    // Initialize with sample data
                    updateGamesDisplay();
                    updateActiveGamesDisplay();
                    updateLiveStats();
                    refreshActivityFeed();
                    
                    console.log('‚úÖ Enhanced platform initialization complete!');
                }, 1500);

            } catch (error) {
                console.error('‚ùå Platform initialization failed:', error);
                updateContractStatus('demo', 'Demo Mode - Limited Features');
            }
        }

        // Event listeners setup
        function setupEventListeners() {
            const connectBtn = document.getElementById('connectBtn');
            const disconnectBtn = document.getElementById('disconnectBtn');
            
            if (connectBtn) connectBtn.addEventListener('click', connectWallet);
            if (disconnectBtn) disconnectBtn.addEventListener('click', disconnectWallet);

            const stakeInput = document.getElementById('gameStake');
            if (stakeInput) {
                stakeInput.addEventListener('input', updateCreateButton);
            }

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && isGameActive) {
                    const confirmClose = confirm('Are you sure you want to close the game?');
                    if (confirmClose && activeGameType) {
                        closeGame(activeGameType);
                    }
                }
            });
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üéÆ Enhanced CrossRealm Platform Loading...');
            
            setupEventListeners();
            
            // Check age verification
            if (checkAgeVerification()) {
                await initializePlatform();
            }
            
            console.log('üöÄ Platform Ready!');
        });

        // Export debug object for testing
        if (typeof window !== 'undefined') {
            window.CrossRealmDebug = {
                connectWallet,
                disconnectWallet,
                createGame,
                joinGame,
                openGameWindow,
                closeGame,
                showSection,
                updateGamesDisplay,
                updateActiveGamesDisplay,
                refreshLobby,
                refreshActiveGames,
                userAccount,
                currentBalance,
                globalGamesList,
                myActiveGames,
                selectedGameType,
                isGameActive,
                activeGameType
            };
        }

        console.log('‚ú® Enhanced CrossRealm Gaming Platform - Complete Implementation Ready!');
    </script>
</body>
</html>
