<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypticus - Play & Earn on Core Blockchain</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .wallet-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .balance {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        .hidden {
            display: none !important;
        }

        /* Navigation */
        nav {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            z-index: 999;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-menu {
            display: flex;
            justify-content: center;
            list-style: none;
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-item {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            transform: translateY(-2px);
        }

        /* Main Content */
        main {
            margin-top: 160px;
            padding: 2rem 0;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section h2 {
            color: #4ecdc4;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(78, 205, 196, 0.2);
        }

        .game-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .game-icon {
            font-size: 2rem;
            margin-right: 1rem;
        }

        .game-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .game-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-top: 1rem;
        }

        .stake-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 0.8rem;
            color: white;
            font-size: 1rem;
        }

        .stake-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        /* Game Board Styles */
        .game-board {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chess-board {
            display: grid;
            grid-template-columns: repeat(8, 40px);
            grid-template-rows: repeat(8, 40px);
            gap: 1px;
            border: 2px solid #4ecdc4;
            border-radius: 8px;
            overflow: hidden;
        }

        .chess-square {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chess-square.light {
            background: #f0d9b5;
            color: #333;
        }

        .chess-square.dark {
            background: #b58863;
            color: #fff;
        }

        .chess-square:hover {
            box-shadow: inset 0 0 0 2px #4ecdc4;
        }

        .chess-square.selected {
            background: #4ecdc4 !important;
            color: white;
        }

        .checkers-board {
            display: grid;
            grid-template-columns: repeat(8, 45px);
            grid-template-rows: repeat(8, 45px);
            gap: 1px;
            border: 2px solid #4ecdc4;
            border-radius: 8px;
            overflow: hidden;
        }

        .checkers-square {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checkers-square.light {
            background: #f0d9b5;
        }

        .checkers-square.dark {
            background: #b58863;
        }

        .checkers-square:hover {
            box-shadow: inset 0 0 0 2px #4ecdc4;
        }

        .word-game-area {
            text-align: center;
            padding: 2rem;
        }

        .word-input {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 1rem;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            margin: 1rem 0;
            width: 100%;
            max-width: 300px;
        }

        .word-display {
            font-size: 2rem;
            font-weight: bold;
            color: #4ecdc4;
            margin: 1rem 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Status and Transaction Display */
        .status-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #4ecdc4;
        }

        .transaction-hash {
            font-family: monospace;
            font-size: 0.9rem;
            color: #4ecdc4;
            word-break: break-all;
            margin-top: 0.5rem;
        }

        /* Active Games */
        .active-games {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .game-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            margin: 0.5rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 3px solid #4ecdc4;
        }

        .game-info {
            flex: 1;
        }

        .game-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }

        .toggle-switch:not(.active) {
            background: rgba(255, 255, 255, 0.2);
        }

        .toggle-switch div {
            position: absolute;
            top: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .toggle-switch.active div {
            left: 33px;
        }

        .toggle-switch:not(.active) div {
            left: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }

            .games-grid {
                grid-template-columns: 1fr;
            }

            .game-controls {
                flex-direction: column;
            }

            .chess-board {
                grid-template-columns: repeat(8, 35px);
                grid-template-rows: repeat(8, 35px);
            }

            .chess-square {
                width: 35px;
                height: 35px;
                font-size: 20px;
            }

            .checkers-board {
                grid-template-columns: repeat(8, 40px);
                grid-template-rows: repeat(8, 40px);
            }

            .checkers-square {
                width: 40px;
                height: 40px;
                font-size: 24px;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .wallet-info {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4ecdc4;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">üéÆ Crypticus</div>
            <div class="wallet-info">
                <div class="balance">
                    <span id="connectionStatus">üî¥ Not Connected</span>
                    <span id="balanceDisplay" class="hidden">0.0000 CORE</span>
                </div>
                <button id="connectBtn" class="btn" onclick="connectWallet()">Connect Wallet</button>
                <button id="disconnectBtn" class="btn btn-danger hidden" onclick="disconnectWallet()">Disconnect</button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <ul class="nav-menu" id="navMenu">
            <li class="nav-item active" onclick="showSection('games')">üéÆ Games</li>
            <li class="nav-item" onclick="showSection('leaderboard')">üèÜ Leaderboard</li>
            <li class="nav-item" onclick="showSection('profile')">üë§ Profile</li>
            <li class="nav-item" onclick="showSection('settings')">‚öôÔ∏è Settings</li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Transaction Status -->
            <div id="transactionStatus" class="status-bar hidden">
                <div id="statusMessage">Ready to play!</div>
                <div id="transactionHash" class="transaction-hash"></div>
            </div>

            <!-- Games Section -->
            <div id="gamesSection" class="section">
                <h2>üéÆ Available Games</h2>
                
                <!-- Active Games Display -->
                <div class="active-games">
                    <h3 style="color: #4ecdc4; margin-bottom: 1rem;">üéØ Active Games</h3>
                    <div id="activeGamesList">
                        <div style="text-align: center; color: #aaa; padding: 2rem;">
                            No active games. Create one to start playing!
                        </div>
                    </div>
                </div>

                <div class="games-grid">
                    <!-- Chess Game -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">‚ôüÔ∏è</div>
                            <div>
                                <div class="game-title">Chess</div>
                                <div style="color: #aaa; font-size: 0.9rem;">Strategic board game</div>
                            </div>
                        </div>
                        <div class="game-controls">
                            <input type="number" id="chessStake" class="stake-input" placeholder="Stake (CORE)" min="0.01" step="0.01" value="0.1">
                            <button class="btn" onclick="startChessGame()">Create Game</button>
                        </div>
                        <div class="game-board">
                            <div id="chessBoard" class="chess-board"></div>
                        </div>
                    </div>

                    <!-- Checkers Game -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">‚ö´</div>
                            <div>
                                <div class="game-title">Checkers</div>
                                <div style="color: #aaa; font-size: 0.9rem;">Classic strategy game</div>
                            </div>
                        </div>
                        <div class="game-controls">
                            <input type="number" id="checkersStake" class="stake-input" placeholder="Stake (CORE)" min="0.01" step="0.01" value="0.1">
                            <button class="btn" onclick="startCheckersGame()">Create Game</button>
                        </div>
                        <div class="game-board">
                            <div id="checkersBoard" class="checkers-board"></div>
                        </div>
                    </div>

                    <!-- Word Challenge Game -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">üìù</div>
                            <div>
                                <div class="game-title">Word Challenge</div>
                                <div style="color: #aaa; font-size: 0.9rem;">Test your vocabulary</div>
                            </div>
                        </div>
                        <div class="game-controls">
                            <input type="number" id="wordStake" class="stake-input" placeholder="Stake (CORE)" min="0.01" step="0.01" value="0.1">
                            <button class="btn" onclick="startWordGame()">Create Game</button>
                        </div>
                        <div class="game-board">
                            <div class="word-game-area">
                                <div class="word-display" id="wordDisplay">Click "Create Game" to start!</div>
                                <input type="text" id="wordInput" class="word-input" placeholder="Enter your word..." maxlength="20">
                                <div>
                                    <button class="btn btn-small" onclick="submitWord()">Submit Word</button>
                                    <button class="btn btn-small" onclick="skipWord()">Skip</button>
                                </div>
                                <div id="wordScore" style="margin-top: 1rem; font-size: 1.2rem; color: #ffd700;">Score: 0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Leaderboard Section -->
            <div id="leaderboardSection" class="hidden">
                <div class="section">
                    <h2>üèÜ Leaderboard</h2>
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="hidden">
                <div class="section">
                    <h2>üë§ Player Profile</h2>
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settingsSection" class="hidden">
                <div class="section">
                    <h2>‚öôÔ∏è Settings</h2>
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Core Blockchain Integration Script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    
    <script>
        // Global Variables
let currentSection = 'games';
let userAddress = null;
let gameContract = null;
let provider = null;
let signer = null;

// Game State Variables
let activeGames = [];
let currentGame = null;

// Player Statistics
let playerStats = {
    gamesPlayed: 0,
    gamesWon: 0,
    totalEarned: 0,
    chessWins: 0,
    checkersWins: 0,
    wordWins: 0
};

// Contract Configuration for Core Blockchain
const CONTRACT_ADDRESS = "0x1234567890abcdef1234567890abcdef12345678"; // Replace with actual contract address
const CONTRACT_ABI = [
    "function createGame(uint256 gameType, uint256 stake) external payable returns (uint256)",
    "function joinGame(uint256 gameId) external payable",
    "function makeMove(uint256 gameId, string memory move) external",
    "function claimWin(uint256 gameId) external",
    "function getGame(uint256 gameId) external view returns (tuple(address player1, address player2, uint256 gameType, uint256 stake, uint256 status))",
    "event GameCreated(uint256 indexed gameId, address indexed creator, uint256 gameType, uint256 stake)",
    "event GameJoined(uint256 indexed gameId, address indexed player2)",
    "event MoveMade(uint256 indexed gameId, address indexed player, string move)",
    "event GameEnded(uint256 indexed gameId, address indexed winner, uint256 prize)"
];

// =============================================================================
// CORE UTILITY FUNCTIONS
// =============================================================================

// Safe DOM Element Selection
function safeGetElement(id) {
    const element = document.getElementById(id);
    if (!element) {
        console.warn(`Element with id '${id}' not found`);
    }
    return element;
}

// Safe Class Toggle
function safeToggleClass(element, className) {
    if (element && element.classList) {
        element.classList.toggle(className);
    }
}

// Safe Class Add/Remove
function safeAddClass(element, className) {
    if (element && element.classList) {
        element.classList.add(className);
    }
}

function safeRemoveClass(element, className) {
    if (element && element.classList) {
        element.classList.remove(className);
    }
}

// =============================================================================
// NAVIGATION FUNCTIONS
// =============================================================================

function showSection(section) {
    try {
        // Hide all sections
        const sections = ['games', 'leaderboard', 'profile', 'settings'];
        sections.forEach(sectionId => {
            const element = safeGetElement(sectionId + 'Section');
            if (element) {
                safeAddClass(element, 'hidden');
            }
        });
        
        // Show selected section
        const targetSection = safeGetElement(section + 'Section');
        if (targetSection) {
            safeRemoveClass(targetSection, 'hidden');
            targetSection.classList.add('fade-in');
        }
        
        // Update navigation active state
        document.querySelectorAll('.nav-item').forEach(item => {
            safeRemoveClass(item, 'active');
        });
        
        // Add active class to clicked item
        if (event && event.target) {
            safeAddClass(event.target, 'active');
        }
        
        currentSection = section;
        
        // Update section content
        if (section === 'profile') {
            updateProfileDisplay();
        } else if (section === 'leaderboard') {
            updateLeaderboard();
        } else if (section === 'settings') {
            updateSettings();
        }
        
    } catch (error) {
        console.error('Error in showSection:', error);
    }
}

// =============================================================================
// WALLET CONNECTION FUNCTIONS
// =============================================================================

async function connectWallet() {
    try {
        if (typeof window.ethereum === 'undefined') {
            alert('MetaMask not detected! Activating demo mode...');
            enableDemoMode();
            return;
        }

        // Request account access
        const accounts = await window.ethereum.request({
            method: 'eth_requestAccounts'
        });

        if (accounts.length === 0) {
            throw new Error('No accounts found');
        }

        userAddress = accounts[0];
        
        // Initialize provider and signer
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        
        // Check if we're on Core network
        const network = await provider.getNetwork();
        if (network.chainId !== 1116) { // Core Mainnet Chain ID
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x45C' }] // 1116 in hex
                });
            } catch (switchError) {
                if (switchError.code === 4902) {
                    await addCoreNetwork();
                }
            }
        }
        
        // Initialize contract (using mock for demo)
        gameContract = createMockContract();
        
        // Update UI
        updateWalletUI();
        await updateBalance();
        
        // Save connection state
        localStorage.setItem('walletConnected', 'true');
        
        showTransactionStatus('‚úÖ Wallet connected successfully to Core Blockchain!');
        
    } catch (error) {
        console.error('Wallet connection error:', error);
        showTransactionStatus('‚ùå Connection failed, using demo mode');
        enableDemoMode();
    }
}

async function addCoreNetwork() {
    try {
        await window.ethereum.request({
            method: 'wallet_addEthereumChain',
            params: [{
                chainId: '0x45C',
                chainName: 'Core Blockchain',
                nativeCurrency: {
                    name: 'CORE',
                    symbol: 'CORE',
                    decimals: 18
                },
                rpcUrls: ['https://rpc.coredao.org'],
                blockExplorerUrls: ['https://scan.coredao.org']
            }]
        });
    } catch (error) {
        console.error('Error adding Core network:', error);
        throw error;
    }
}

function enableDemoMode() {
    userAddress = '0x' + Math.random().toString(16).substr(2, 40);
    gameContract = createMockContract();
    
    updateWalletUI();
    
    const balanceElement = safeGetElement('balanceDisplay');
    if (balanceElement) {
        balanceElement.textContent = '5.0000 CORE';
    }
    
    showTransactionStatus('‚úÖ Demo mode activated! Games fully functional.');
}

function createMockContract() {
    return {
        createGame: async (gameType, stake, options) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const mockTx = {
                        hash: '0x' + Math.random().toString(16).substr(2, 64),
                        wait: async () => ({
                            events: [{
                                event: 'GameCreated',
                                args: { gameId: Math.floor(Math.random() * 10000) }
                            }]
                        })
                    };
                    resolve(mockTx);
                }, 1000);
            });
        },
        
        joinGame: async (gameId, options) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const mockTx = {
                        hash: '0x' + Math.random().toString(16).substr(2, 64),
                        wait: async () => ({})
                    };
                    resolve(mockTx);
                }, 1000);
            });
        },
        
        makeMove: async (gameId, move) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const mockTx = {
                        hash: '0x' + Math.random().toString(16).substr(2, 64),
                        wait: async () => ({})
                    };
                    resolve(mockTx);
                }, 500);
            });
        },
        
        claimWin: async (gameId) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const mockTx = {
                        hash: '0x' + Math.random().toString(16).substr(2, 64),
                        wait: async () => ({})
                    };
                    resolve(mockTx);
                }, 1000);
            });
        }
    };
}

function updateWalletUI() {
    const connectionStatus = safeGetElement('connectionStatus');
    const balanceDisplay = safeGetElement('balanceDisplay');
    const connectBtn = safeGetElement('connectBtn');
    const disconnectBtn = safeGetElement('disconnectBtn');
    
    if (userAddress) {
        if (connectionStatus) {
            connectionStatus.innerHTML = userAddress.length === 42 ? 
                'üü¢ Connected' : 'üü° Demo Mode';
        }
        
        if (balanceDisplay) {
            safeRemoveClass(balanceDisplay, 'hidden');
        }
        
        if (connectBtn) {
            safeAddClass(connectBtn, 'hidden');
        }
        
        if (disconnectBtn) {
            safeRemoveClass(disconnectBtn, 'hidden');
        }
    }
}

async function updateBalance() {
    if (!provider || !userAddress) return;
    
    try {
        const balance = await provider.getBalance(userAddress);
        const balanceInCore = ethers.utils.formatEther(balance);
        
        const balanceElement = safeGetElement('balanceDisplay');
        if (balanceElement) {
            balanceElement.textContent = `${parseFloat(balanceInCore).toFixed(4)} CORE`;
        }
    } catch (error) {
        console.error('Error updating balance:', error);
        const balanceElement = safeGetElement('balanceDisplay');
        if (balanceElement) {
            balanceElement.textContent = '5.0000 CORE';
        }
    }
}

function disconnectWallet() {
    userAddress = null;
    provider = null;
    signer = null;
    gameContract = null;
    
    const connectionStatus = safeGetElement('connectionStatus');
    const balanceDisplay = safeGetElement('balanceDisplay');
    const connectBtn = safeGetElement('connectBtn');
    const disconnectBtn = safeGetElement('disconnectBtn');
    
    if (connectionStatus) {
        connectionStatus.innerHTML = 'üî¥ Not Connected';
    }
    
    if (balanceDisplay) {
        safeAddClass(balanceDisplay, 'hidden');
    }
    
    if (connectBtn) {
        safeRemoveClass(connectBtn, 'hidden');
    }
    
    if (disconnectBtn) {
        safeAddClass(disconnectBtn, 'hidden');
    }
    
    // Clear connection state
    localStorage.removeItem('walletConnected');
    
    showTransactionStatus('üëã Wallet disconnected');
}

// =============================================================================
// TRANSACTION STATUS FUNCTIONS
// =============================================================================

function showTransactionStatus(message, hash = null) {
    const statusElement = safeGetElement('transactionStatus');
    const messageElement = safeGetElement('statusMessage');
    const hashElement = safeGetElement('transactionHash');
    
    if (statusElement) {
        safeRemoveClass(statusElement, 'hidden');
    }
    
    if (messageElement) {
        messageElement.textContent = message;
    }
    
    if (hashElement && hash) {
        hashElement.innerHTML = `TX: <a href="https://scan.coredao.org/tx/${hash}" target="_blank" style="color: #4ecdc4;">${hash.substring(0, 20)}...</a>`;
    } else if (hashElement) {
        hashElement.textContent = '';
    }
    
    // Auto-hide after 10 seconds
    setTimeout(() => {
        if (statusElement) {
            safeAddClass(statusElement, 'hidden');
        }
    }, 10000);
}

// Listen for account changes
if (window.ethereum) {
    window.ethereum.on('accountsChanged', function (accounts) {
        if (accounts.length === 0) {
            disconnectWallet();
        } else {
            userAddress = accounts[0];
            updateWalletUI();
            updateBalance();
        }
    });
    
    window.ethereum.on('chainChanged', function (chainId) {
        window.location.reload();
    });
}

console.log('‚úÖ Part 2A: Core Functions & Wallet Connection - Loaded');
        console.log('üéÆ Crypticus Gaming Platform - HTML Structure Loaded');
    </script>
</body>
</html>
